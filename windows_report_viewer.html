<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<title>Windows åº”æ€¥å“åº”æŠ¥å‘ŠæŸ¥çœ‹å™¨ (è¯¦ç»†ç‰ˆ)</title>
<style>
body { 
  font-family: "Microsoft YaHei", Arial, sans-serif; 
  background: #f5f5f5; 
  margin: 0;
  padding: 0;
}

.header {
  background: linear-gradient(135deg, #2c3e50 0%, #3498db 100%);
  color: white;
  padding: 20px;
  text-align: center;
  box-shadow: 0 2px 10px rgba(0,0,0,0.1);
}

.header h1 {
  margin: 0;
  font-size: 2.2em;
  text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
}

.subtitle {
  margin-top: 8px;
  font-size: 1.1em;
  opacity: 0.9;
}

.main-container {
  display: flex;
  max-width: 1400px;
  margin: 20px auto;
  gap: 20px;
  padding: 0 20px;
}

.content-container {
  flex: 1;
  background: white;
  border-radius: 10px;
  box-shadow: 0 4px 15px rgba(0,0,0,0.1);
  overflow: hidden;
}

.search-container {
  padding: 20px;
  background: #f8f9fa;
  border-bottom: 1px solid #dee2e6;
  display: flex;
  gap: 15px;
  align-items: center;
  flex-wrap: wrap;
}

.search-container input[type="file"] {
  padding: 10px;
  border: 2px solid #3498db;
  border-radius: 5px;
  background: white;
  font-size: 14px;
}

.search-container input[type="text"] {
  flex: 1;
  min-width: 200px;
  padding: 10px;
  border: 2px solid #bdc3c7;
  border-radius: 5px;
  font-size: 14px;
}

.search-container input[type="text"]:focus {
  border-color: #3498db;
  outline: none;
}

.search-nav {
  display: flex;
  gap: 10px;
  align-items: center;
}

.search-nav button {
  padding: 8px 15px;
  background: #3498db;
  color: white;
  border: none;
  border-radius: 5px;
  cursor: pointer;
  font-size: 12px;
}

.search-nav button:disabled {
  background: #bdc3c7;
  cursor: not-allowed;
}

.search-nav button:hover:not(:disabled) {
  background: #2980b9;
}

#searchCount {
  font-size: 12px;
  color: #7f8c8d;
  white-space: nowrap;
}

.tabs {
  display: flex;
  background: #ecf0f1;
  border-bottom: 1px solid #bdc3c7;
  overflow-x: auto;
}

.tablinks {
  background: none;
  border: none;
  padding: 15px 20px;
  cursor: pointer;
  font-size: 14px;
  color: #2c3e50;
  white-space: nowrap;
  transition: all 0.3s ease;
  border-bottom: 3px solid transparent;
}

.tablinks:hover {
  background: #d5dbdb;
}

.tablinks.active {
  background: white;
  color: #3498db;
  border-bottom-color: #3498db;
}

.tabcontent {
  display: none;
  padding: 25px;
  max-height: 70vh;
  overflow-y: auto;
}

.tabcontent.active {
  display: block;
}

details {
  margin: 15px 0;
  border: 1px solid #dee2e6;
  border-radius: 8px;
  overflow: hidden;
}

summary {
  background: #f8f9fa;
  padding: 15px 20px;
  cursor: pointer;
  font-weight: bold;
  color: #2c3e50;
  border-bottom: 1px solid #dee2e6;
  transition: background 0.3s ease;
}

summary:hover {
  background: #e9ecef;
}

details[open] summary {
  background: #3498db;
  color: white;
}

details div {
  padding: 20px;
  background: white;
}

pre {
  background: #f8f9fa;
  padding: 15px;
  border-radius: 5px;
  border-left: 4px solid #3498db;
  overflow-x: auto;
  font-family: "Consolas", "Monaco", monospace;
  font-size: 13px;
  line-height: 1.4;
  margin: 0;
  white-space: pre-wrap;
  word-wrap: break-word;
}

.sidebar {
  width: 350px;
  background: white;
  border-radius: 10px;
  box-shadow: 0 4px 15px rgba(0,0,0,0.1);
  height: fit-content;
  max-height: 80vh;
  overflow: hidden;
  display: flex;
  flex-direction: column;
}

.sidebar-header {
  background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
  color: white;
  padding: 20px;
  text-align: center;
  position: relative;
}

.sidebar-header h3 {
  margin: 0;
  font-size: 1.3em;
}

.collapse-button {
  position: absolute;
  top: 50%;
  right: 15px;
  transform: translateY(-50%);
  background: rgba(255,255,255,0.2);
  color: white;
  border: none;
  padding: 5px 10px;
  border-radius: 15px;
  cursor: pointer;
  font-size: 12px;
  transition: background 0.3s ease;
}

.collapse-button:hover {
  background: rgba(255,255,255,0.3);
}

.alert-summary {
  margin-top: 15px;
  padding: 15px;
  background: rgba(255,255,255,0.1);
  border-radius: 8px;
  font-size: 14px;
}

.alert-container {
  flex: 1;
  overflow-y: auto;
  padding: 20px;
}

.alert-item {
  margin: 15px 0;
  padding: 15px;
  border-radius: 8px;
  border-left: 4px solid;
  font-size: 14px;
  line-height: 1.5;
}

.alert-high {
  background: #fdf2f2;
  border-color: #e53e3e;
  color: #742a2a;
}

.alert-medium {
  background: #fffbf0;
  border-color: #dd6b20;
  color: #7c2d12;
}

.alert-low {
  background: #f0fff4;
  border-color: #38a169;
  color: #22543d;
}

.alert-item h4 {
  margin: 0 0 8px 0;
  font-size: 15px;
}

.alert-item p {
  margin: 5px 0;
  font-size: 13px;
}

.highlight {
  background: #fff3cd !important;
  border: 2px solid #ffc107 !important;
  border-radius: 4px;
  padding: 2px 4px;
}

.sidebar.collapsed {
  width: 60px;
}

.sidebar.collapsed .sidebar-header h3,
.sidebar.collapsed .alert-summary,
.sidebar.collapsed .alert-container {
  display: none;
}

.sidebar.collapsed .collapse-button {
  right: 50%;
  transform: translate(50%, -50%);
}

@media (max-width: 768px) {
  .main-container {
    flex-direction: column;
    padding: 0 10px;
  }
  
  .sidebar {
    width: 100%;
    order: -1;
  }
  
  .search-container {
    flex-direction: column;
    align-items: stretch;
  }
  
  .search-nav {
    justify-content: center;
  }
  
  .tabs {
    flex-wrap: wrap;
  }
  
  .tablinks {
    flex: 1;
    min-width: 120px;
    text-align: center;
  }
}

/* æ•™ç¨‹æ ·å¼ */
.tutorial-content {
  background: #f8f9fa;
  padding: 20px;
  border-radius: 10px;
  margin: 10px 0;
}

.tutorial-content h3 {
  color: #2c3e50;
  margin-bottom: 20px;
  font-size: 1.5em;
  border-bottom: 2px solid #3498db;
  padding-bottom: 10px;
}

.tutorial-content h4 {
  color: #34495e;
  margin: 20px 0 10px 0;
  font-size: 1.2em;
}

.tutorial-content ul, .tutorial-content ol {
  margin: 15px 0;
  padding-left: 25px;
}

.tutorial-content li {
  margin: 8px 0;
  line-height: 1.6;
}

.tutorial-content .command-block {
  background: #2d3748;
  color: #e2e8f0;
  padding: 15px;
  border-radius: 5px;
  font-family: "Consolas", "Monaco", monospace;
  margin: 15px 0;
  overflow-x: auto;
}

.tutorial-content .warning {
  background: #fff3cd;
  border: 1px solid #ffeaa7;
  border-radius: 5px;
  padding: 15px;
  margin: 15px 0;
}

.tutorial-content .tip {
  background: #d1ecf1;
  border: 1px solid #bee5eb;
  border-radius: 5px;
  padding: 15px;
  margin: 15px 0;
}

/* å‘Šè­¦é¢æ¿æ ·å¼ */
.alert-group {
  margin-bottom: 15px;
  padding: 10px;
  border-radius: 5px;
  border-left: 4px solid;
}

.alert-group.high-risk {
  background-color: #fff5f5;
  border-left-color: #e53e3e;
}

.alert-group.medium-risk {
  background-color: #fffbf0;
  border-left-color: #dd6b20;
}

.alert-item {
  margin-bottom: 10px;
  padding: 8px;
  background-color: rgba(255,255,255,0.7);
  border-radius: 3px;
}

.alert-desc {
  color: #666;
  font-size: 14px;
}

.recommendations {
  margin-top: 20px;
  padding: 15px;
  background-color: #f0f8ff;
  border-radius: 5px;
  border-left: 4px solid #3182ce;
}

.recommendation-item {
  margin-bottom: 15px;
}

.recommendation-item h5 {
  margin: 0 0 8px 0;
  color: #2d3748;
}

.recommendation-item ul {
  margin: 5px 0;
  padding-left: 20px;
}

.emergency-actions {
  margin-top: 10px;
  padding: 8px;
  background-color: #fed7d7;
  border-radius: 3px;
}

.no-alerts {
  text-align: center;
  padding: 20px;
  color: #38a169;
  font-size: 16px;
}

/* æç¤ºæ¶ˆæ¯æ ·å¼ */
.alert {
  position: fixed;
  top: 20px;
  right: 20px;
  padding: 12px 20px;
  border-radius: 5px;
  color: white;
  font-weight: bold;
  z-index: 1000;
  max-width: 400px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  box-shadow: 0 4px 6px rgba(0,0,0,0.1);
}

.alert-info {
  background-color: #3182ce;
}

.alert-success {
  background-color: #38a169;
}

.alert-error {
  background-color: #e53e3e;
}

.alert button {
  background: none;
  border: none;
  color: white;
  font-size: 18px;
  cursor: pointer;
  margin-left: 10px;
}
</style>

<script>
// å…¨å±€å˜é‡
const TAB_TITLES = {
  summary: "ğŸ“Š ç³»ç»Ÿæ¦‚è§ˆ",
  system: "ğŸ’» ç³»ç»Ÿä¿¡æ¯", 
  user: "ğŸ‘¥ ç”¨æˆ·æƒé™",
  process: "âš™ï¸ è¿›ç¨‹æœåŠ¡",
  network: "ğŸŒ ç½‘ç»œè¿æ¥",
  filesystem: "ğŸ“ æ–‡ä»¶ç³»ç»Ÿ",
  registry: "ğŸ“‹ æ³¨å†Œè¡¨",
  logs: "ğŸ“‹ æ—¥å¿—åˆ†æ",
  tasks: "â° è®¡åˆ’ä»»åŠ¡",
  malware: "ğŸ¦  æ¶æ„è½¯ä»¶æ£€æµ‹",
  patches: "ğŸ”§ è¡¥ä¸ä¿¡æ¯",
  environment: "ğŸŒ ç¯å¢ƒå˜é‡",
  services: "ğŸ”§ ç³»ç»ŸæœåŠ¡",
  startup: "ğŸš€ å¯åŠ¨é¡¹",
  recent_files: "ğŸ“‹ è®¿é—®è®°å½•",
  stats: "ğŸ“ˆ å®‰å…¨ç»Ÿè®¡",
  guide: "ğŸ“– åº”æ€¥æŒ‡å—"
};

const SUB_TAB_TITLES = {
  summary: ["ç³»ç»Ÿæ¦‚è§ˆ", "é£é™©è¯„ä¼°", "æ™ºèƒ½å»ºè®®", "æ£€æŸ¥æ¸…å•", "ä¸“ä¸šæ€»ç»“"],
  system: ["ğŸ“š æ’æŸ¥æ•™ç¨‹", "ç³»ç»Ÿä¿¡æ¯æ¦‚è§ˆ", "ç¡¬ä»¶ä¿¡æ¯", "è¯¦ç»†ç³»ç»Ÿä¿¡æ¯"],
  user: ["ğŸ“š æ’æŸ¥æ•™ç¨‹", "ç”¨æˆ·è¯¦æƒ…", "ç®¡ç†å‘˜åˆ—è¡¨", "ç»Ÿè®¡ä¿¡æ¯"],
  process: ["ğŸ“š æ’æŸ¥æ•™ç¨‹", "è¿›ç¨‹è¯¦æƒ…", "é«˜CPUè¿›ç¨‹", "å¯ç–‘è¿›ç¨‹", "ç»Ÿè®¡ä¿¡æ¯"],
  network: ["ğŸ“š æ’æŸ¥æ•™ç¨‹", "æ´»åŠ¨è¿æ¥", "ç›‘å¬ç«¯å£", "å¯ç–‘è¿æ¥", "ç½‘ç»œé…ç½®", "DNSé…ç½®", "ç»Ÿè®¡ä¿¡æ¯"],
  filesystem: ["ğŸ“š æ’æŸ¥æ•™ç¨‹", "å¯ç–‘æ–‡ä»¶", "æœ€è¿‘ä¿®æ”¹æ–‡ä»¶", "ä¸´æ—¶ç›®å½•æ–‡ä»¶", "ä¸‹è½½ç›®å½•æ–‡ä»¶", "ç³»ç»Ÿæ–‡ä»¶æ£€æŸ¥", "ç»Ÿè®¡ä¿¡æ¯"],
  registry: ["ğŸ“š æ’æŸ¥æ•™ç¨‹", "æ‰€æœ‰å¯åŠ¨é¡¹", "æ³¨å†Œè¡¨å¯åŠ¨é¡¹", "å¯ç–‘å¯åŠ¨é¡¹", "WMICå¯åŠ¨é¡¹", "ç»Ÿè®¡ä¿¡æ¯"],
  logs: ["ğŸ“š æ’æŸ¥æ•™ç¨‹", "å®‰å…¨æ—¥å¿—æ ·æœ¬", "ç³»ç»Ÿæ—¥å¿—æ ·æœ¬", "åº”ç”¨ç¨‹åºæ—¥å¿—æ ·æœ¬", "ç™»å½•å¤±è´¥æ¬¡æ•°", "ç³»ç»Ÿé”™è¯¯æ•°", "åº”ç”¨ç¨‹åºé”™è¯¯æ•°"],
  tasks: ["ğŸ“š æ’æŸ¥æ•™ç¨‹", "æ‰€æœ‰ä»»åŠ¡", "æ´»åŠ¨ä»»åŠ¡", "å¯ç–‘ä»»åŠ¡", "ç»Ÿè®¡ä¿¡æ¯"],
  malware: ["ğŸ“š æ’æŸ¥æ•™ç¨‹", "æœåŠ¡çŠ¶æ€", "æ³¨å†Œè¡¨é…ç½®", "æ’é™¤é¡¹é…ç½®"],
  patches: ["ğŸ“š æ’æŸ¥æ•™ç¨‹", "è¡¥ä¸åˆ—è¡¨", "ç»Ÿè®¡ä¿¡æ¯"],
  environment: ["ğŸ“š æ’æŸ¥æ•™ç¨‹", "é‡è¦ç¯å¢ƒå˜é‡", "å¯ç–‘ç¯å¢ƒå˜é‡", "ç»Ÿè®¡ä¿¡æ¯"],
  services: ["ğŸ“š æ’æŸ¥æ•™ç¨‹", "æœåŠ¡è¯¦æƒ…", "è¿è¡Œä¸­æœåŠ¡", "å¯ç–‘æœåŠ¡", "æœåŠ¡è¯¦ç»†ä¿¡æ¯", "ç»Ÿè®¡ä¿¡æ¯"],
  startup: ["ğŸ“š æ’æŸ¥æ•™ç¨‹", "æ‰€æœ‰å¯åŠ¨é¡¹", "æ³¨å†Œè¡¨å¯åŠ¨é¡¹", "å¯ç–‘å¯åŠ¨é¡¹", "WMICå¯åŠ¨é¡¹", "ç»Ÿè®¡ä¿¡æ¯"],
  recent_files: ["ğŸ“š æ’æŸ¥æ•™ç¨‹", "æœ€è¿‘æ–‡æ¡£", "æµè§ˆå™¨æ•°æ®", "ç»Ÿè®¡ä¿¡æ¯"],
  stats: ["ğŸ“š ç»Ÿè®¡æ•™ç¨‹", "ç”¨æˆ·å®‰å…¨ç»Ÿè®¡", "è¿›ç¨‹å®‰å…¨ç»Ÿè®¡", "ç½‘ç»œå®‰å…¨ç»Ÿè®¡", "æ–‡ä»¶ç³»ç»Ÿç»Ÿè®¡", "æ³¨å†Œè¡¨ç»Ÿè®¡", "è®¡åˆ’ä»»åŠ¡ç»Ÿè®¡", "æ—¥å¿—ç»Ÿè®¡", "å®‰å…¨é˜²æŠ¤çŠ¶æ€", "å®‰å…¨é£é™©è¯„ä¼°", "ä¸“ä¸šå®‰å…¨å»ºè®®"],
  guide: ["ğŸ¯ åº”æ€¥å“åº”æµç¨‹", "ğŸ” åˆ¤æ–­æŠ€å·§å¤§å…¨", "ğŸ“‹ æ£€æŸ¥æ¸…å•", "ğŸ’¡ ä¸“ä¸šå»ºè®®", "ğŸ› ï¸ å·¥å…·ä½¿ç”¨", "ğŸ“š å­¦ä¹ èµ„æº"]
};

let gTabs = Object.keys(TAB_TITLES);
let gContent = "";
let currentSearchIndex = -1;
let searchMatches = [];
let analysisData = null;

// ç”ŸæˆWindowsæ•™ç¨‹å†…å®¹
function generateWindowsTutorial(category) {
  const tutorials = {
    system: `
<div class="tutorial-content">
<h3>ğŸ›¡ï¸ Windowsç³»ç»Ÿä¿¡æ¯å®‰å…¨æ£€æŸ¥æŒ‡å—</h3>

<h4>ğŸ“– ç³»ç»Ÿä¿¡æ¯æ£€æŸ¥çš„é‡è¦æ€§</h4>
<p>ç³»ç»Ÿä¿¡æ¯æ˜¯äº†è§£Windowsç¯å¢ƒå®‰å…¨çŠ¶å†µçš„åŸºç¡€ã€‚é€šè¿‡ç³»ç»Ÿä¿¡æ¯æ£€æŸ¥å¯ä»¥å‘ç°ç³»ç»Ÿæ¼æ´ã€é…ç½®é—®é¢˜å’Œæ½œåœ¨çš„å®‰å…¨é£é™©ã€‚</p>

<h4>ğŸ” æ£€æŸ¥è¦ç‚¹</h4>
<ol>
<li><strong>æ“ä½œç³»ç»Ÿç‰ˆæœ¬</strong> - ç¡®è®¤ç³»ç»Ÿç‰ˆæœ¬å’Œè¡¥ä¸çº§åˆ«</li>
<li><strong>è¡¥ä¸å®‰è£…æƒ…å†µ</strong> - æ£€æŸ¥å…³é”®å®‰å…¨è¡¥ä¸æ˜¯å¦å®‰è£…</li>
<li><strong>ç³»ç»Ÿé…ç½®</strong> - éªŒè¯å®‰å…¨é…ç½®æ˜¯å¦åˆè§„</li>
<li><strong>ç¡¬ä»¶ä¿¡æ¯</strong> - äº†è§£ç³»ç»Ÿç¡¬ä»¶é…ç½®</li>
<li><strong>ç¯å¢ƒå˜é‡</strong> - æ£€æŸ¥å¯èƒ½è¢«åŠ«æŒçš„ç¯å¢ƒå˜é‡</li>
</ol>

<h4>ğŸ’» å…³é”®PowerShellå‘½ä»¤</h4>
<div class="command-block">
# 1. è·å–ç³»ç»ŸåŸºæœ¬ä¿¡æ¯
Get-ComputerInfo

# 2. æŸ¥çœ‹æ“ä½œç³»ç»Ÿè¯¦ç»†ä¿¡æ¯
Get-CimInstance -ClassName Win32_OperatingSystem

# 3. æ£€æŸ¥å·²å®‰è£…çš„è¡¥ä¸
Get-HotFix | Sort-Object InstalledOn -Descending

# 4. æŸ¥çœ‹ç³»ç»Ÿå¯åŠ¨æ—¶é—´
Get-CimInstance -ClassName Win32_OperatingSystem | Select-Object LastBootUpTime

# 5. æ£€æŸ¥ç¯å¢ƒå˜é‡
Get-ChildItem Env:

# 6. æŸ¥çœ‹ç³»ç»ŸæœåŠ¡
Get-Service | Where-Object {$_.Status -eq "Running"}

# 7. æ£€æŸ¥WindowsåŠŸèƒ½
Get-WindowsOptionalFeature -Online | Where-Object {$_.State -eq "Enabled"}
</div>

<h4>ğŸš¨ å®‰å…¨æ£€æŸ¥é‡ç‚¹</h4>
<ul>
<li><strong>è¡¥ä¸ç®¡ç†</strong> - ç¡®ä¿å…³é”®å®‰å…¨è¡¥ä¸å·²å®‰è£…</li>
<li><strong>ç³»ç»Ÿç‰ˆæœ¬</strong> - ä½¿ç”¨å—æ”¯æŒçš„Windowsç‰ˆæœ¬</li>
<li><strong>å¯åŠ¨æ—¶é—´</strong> - å¼‚å¸¸çš„é‡å¯å¯èƒ½è¡¨ç¤ºç³»ç»Ÿè¢«æ”»å‡»</li>
<li><strong>ç¯å¢ƒå˜é‡</strong> - PATHç­‰å˜é‡æ˜¯å¦è¢«æ¶æ„ä¿®æ”¹</li>
<li><strong>ç³»ç»ŸåŠŸèƒ½</strong> - ä¸å¿…è¦çš„åŠŸèƒ½åº”è¯¥è¢«ç¦ç”¨</li>
</ul>

<h4>âš ï¸ æ³¨æ„äº‹é¡¹</h4>
<ul>
<li>å®šæœŸæ£€æŸ¥Windows UpdateçŠ¶æ€</li>
<li>å…³æ³¨Microsoftå®‰å…¨å…¬å‘Š</li>
<li>ç›‘æ§ç³»ç»Ÿé…ç½®å˜åŒ–</li>
<li>å»ºç«‹ç³»ç»ŸåŸºçº¿é…ç½®</li>
</ul>
</div>
    `,
    
    user: `
<div class="tutorial-content">
<h3>ğŸ‘¥ Windowsç”¨æˆ·æƒé™å®‰å…¨æ£€æŸ¥æŒ‡å—</h3>

<h4>ğŸ“– ç”¨æˆ·æƒé™æ£€æŸ¥çš„é‡è¦æ€§</h4>
<p>ç”¨æˆ·è´¦æˆ·ç®¡ç†æ˜¯Windowså®‰å…¨çš„æ ¸å¿ƒã€‚æ”»å‡»è€…å¸¸å¸¸é€šè¿‡åˆ›å»ºåé—¨è´¦æˆ·ã€æå‡æƒé™æˆ–åˆ©ç”¨å¼±å¯†ç æ¥ç»´æŒç³»ç»Ÿè®¿é—®ã€‚</p>

<h4>ğŸ” æ£€æŸ¥è¦ç‚¹</h4>
<ol>
<li><strong>æœ¬åœ°ç”¨æˆ·è´¦æˆ·</strong> - æ£€æŸ¥æ‰€æœ‰æœ¬åœ°ç”¨æˆ·çš„åˆæ³•æ€§</li>
<li><strong>ç®¡ç†å‘˜æƒé™</strong> - å®¡æŸ¥ç®¡ç†å‘˜ç»„æˆå‘˜</li>
<li><strong>ç™»å½•æ´»åŠ¨</strong> - åˆ†æç”¨æˆ·ç™»å½•è¡Œä¸º</li>
<li><strong>å¯†ç ç­–ç•¥</strong> - éªŒè¯å¯†ç å®‰å…¨ç­–ç•¥</li>
<li><strong>ç”¨æˆ·ç»„æƒé™</strong> - æ£€æŸ¥ç”¨æˆ·ç»„é…ç½®</li>
</ol>

<h4>ğŸ’» å…³é”®PowerShellå‘½ä»¤</h4>
<div class="command-block">
# 1. æŸ¥çœ‹æœ¬åœ°ç”¨æˆ·è´¦æˆ·
Get-LocalUser

# 2. æ£€æŸ¥ç®¡ç†å‘˜ç»„æˆå‘˜
Get-LocalGroupMember -Group "Administrators"

# 3. æŸ¥çœ‹æ‰€æœ‰æœ¬åœ°ç»„
Get-LocalGroup

# 4. æ£€æŸ¥å½“å‰ç™»å½•ç”¨æˆ·
Get-CimInstance -ClassName Win32_LoggedOnUser

# 5. æŸ¥çœ‹ç”¨æˆ·ç™»å½•å†å²
Get-WinEvent -FilterHashtable @{LogName='Security'; ID=4624} -MaxEvents 50

# 6. æ£€æŸ¥ç™»å½•å¤±è´¥è®°å½•
Get-WinEvent -FilterHashtable @{LogName='Security'; ID=4625} -MaxEvents 50

# 7. æŸ¥çœ‹å¯†ç ç­–ç•¥
net accounts

# 8. æ£€æŸ¥ç”¨æˆ·æƒé™åˆ†é…
secedit /export /cfg security_config.txt
</div>

<h4>ğŸš¨ å®‰å…¨é£é™©è¯†åˆ«</h4>
<ul>
<li><strong>å¼‚å¸¸ç®¡ç†å‘˜è´¦æˆ·</strong> - æ£€æŸ¥æ˜¯å¦æœ‰æœªæˆæƒçš„ç®¡ç†å‘˜</li>
<li><strong>é»˜è®¤è´¦æˆ·çŠ¶æ€</strong> - Guestè´¦æˆ·åº”è¯¥è¢«ç¦ç”¨</li>
<li><strong>å¼±å¯†ç ç­–ç•¥</strong> - å¯†ç å¤æ‚åº¦å’Œè¿‡æœŸç­–ç•¥</li>
<li><strong>å¼‚å¸¸ç™»å½•æ—¶é—´</strong> - éå·¥ä½œæ—¶é—´çš„ç™»å½•æ´»åŠ¨</li>
<li><strong>ç™»å½•å¤±è´¥æ¨¡å¼</strong> - æš´åŠ›ç ´è§£æ”»å‡»è¿¹è±¡</li>
</ul>

<h4>ğŸ›¡ï¸ å®‰å…¨å»ºè®®</h4>
<ul>
<li>å®æ–½æœ€å°æƒé™åŸåˆ™</li>
<li>å®šæœŸå®¡æŸ¥ç”¨æˆ·è´¦æˆ·</li>
<li>å¯ç”¨è´¦æˆ·é”å®šç­–ç•¥</li>
<li>ä½¿ç”¨å¼ºå¯†ç ç­–ç•¥</li>
<li>ç›‘æ§ç™»å½•æ´»åŠ¨</li>
</ul>
</div>
    `,
    
    process: `
<div class="tutorial-content">
<h3>âš™ï¸ Windowsè¿›ç¨‹æœåŠ¡å®‰å…¨æ£€æŸ¥æŒ‡å—</h3>

<h4>ğŸ“– è¿›ç¨‹æœåŠ¡æ£€æŸ¥çš„é‡è¦æ€§</h4>
<p>æ¶æ„è¿›ç¨‹å’ŒæœåŠ¡æ˜¯æ”»å‡»è€…åœ¨Windowsç³»ç»Ÿä¸­æ‰§è¡Œæ¶æ„æ´»åŠ¨çš„ä¸»è¦è½½ä½“ã€‚é€šè¿‡è¿›ç¨‹åˆ†æå¯ä»¥å‘ç°åé—¨ç¨‹åºã€æ¶æ„è½¯ä»¶å’Œå¼‚å¸¸æ´»åŠ¨ã€‚</p>

<h4>ğŸ” æ£€æŸ¥è¦ç‚¹</h4>
<ol>
<li><strong>è¿›ç¨‹è¡Œä¸ºåˆ†æ</strong> - åˆ†æè¿›ç¨‹çš„èµ„æºä½¿ç”¨å’Œè¡Œä¸º</li>
<li><strong>æœåŠ¡çŠ¶æ€æ£€æŸ¥</strong> - æ£€æŸ¥ç³»ç»ŸæœåŠ¡çš„åˆæ³•æ€§</li>
<li><strong>å¯åŠ¨é¡¹å®¡æŸ¥</strong> - æ£€æŸ¥è‡ªå¯åŠ¨ç¨‹åº</li>
<li><strong>è¿›ç¨‹ç­¾åéªŒè¯</strong> - éªŒè¯è¿›ç¨‹çš„æ•°å­—ç­¾å</li>
<li><strong>ç½‘ç»œè¿æ¥å…³è”</strong> - åˆ†æè¿›ç¨‹çš„ç½‘ç»œæ´»åŠ¨</li>
</ol>

<h4>ğŸ’» å…³é”®PowerShellå‘½ä»¤</h4>
<div class="command-block">
# 1. æŸ¥çœ‹æ‰€æœ‰è¿›ç¨‹è¯¦ç»†ä¿¡æ¯
Get-Process | Select-Object Name, Id, CPU, WorkingSet, Path

# 2. æŒ‰CPUä½¿ç”¨ç‡æ’åº
Get-Process | Sort-Object CPU -Descending | Select-Object -First 20

# 3. æŸ¥çœ‹è¿›ç¨‹çš„ç½‘ç»œè¿æ¥
Get-NetTCPConnection | Select-Object LocalAddress, LocalPort, RemoteAddress, RemotePort, State, OwningProcess

# 4. æ£€æŸ¥ç³»ç»ŸæœåŠ¡
Get-Service | Where-Object {$_.Status -eq "Running"}

# 5. æŸ¥çœ‹æœåŠ¡è¯¦ç»†ä¿¡æ¯
Get-CimInstance -ClassName Win32_Service | Select-Object Name, DisplayName, State, PathName

# 6. æ£€æŸ¥å¯åŠ¨é¡¹
Get-CimInstance -ClassName Win32_StartupCommand

# 7. æŸ¥çœ‹è¿›ç¨‹æ¨¡å—
Get-Process -Name "processname" | Select-Object -ExpandProperty Modules

# 8. æ£€æŸ¥è¿›ç¨‹çš„æ•°å­—ç­¾å
Get-AuthenticodeSignature -FilePath "C:\path\to\executable.exe"
</div>

<h4>ğŸš¨ å¯ç–‘è¿›ç¨‹ç‰¹å¾</h4>
<ul>
<li><strong>é«˜èµ„æºå ç”¨</strong> - å¼‚å¸¸é«˜çš„CPUæˆ–å†…å­˜ä½¿ç”¨</li>
<li><strong>å¼‚å¸¸è·¯å¾„</strong> - ä»ä¸´æ—¶ç›®å½•æˆ–ç”¨æˆ·ç›®å½•è¿è¡Œ</li>
<li><strong>æ— ç­¾åæ–‡ä»¶</strong> - ç¼ºå°‘æ•°å­—ç­¾åçš„å¯æ‰§è¡Œæ–‡ä»¶</li>
<li><strong>éšè—è¿›ç¨‹</strong> - ä½¿ç”¨ç‰¹æ®ŠæŠ€æœ¯éšè—çš„è¿›ç¨‹</li>
<li><strong>ç½‘ç»œæ´»åŠ¨</strong> - å¼‚å¸¸çš„ç½‘ç»œè¿æ¥è¡Œä¸º</li>
</ul>

<h4>ğŸ›¡ï¸ é˜²æŠ¤å»ºè®®</h4>
<ul>
<li>å®šæœŸç›‘æ§è¿›ç¨‹æ´»åŠ¨</li>
<li>ä½¿ç”¨åº”ç”¨ç¨‹åºç™½åå•</li>
<li>å¯ç”¨è¿›ç¨‹å®¡è®¡</li>
<li>ç›‘æ§æœåŠ¡çŠ¶æ€å˜åŒ–</li>
<li>éªŒè¯å¯æ‰§è¡Œæ–‡ä»¶ç­¾å</li>
</ul>
</div>
    `,
    
    network: `
<div class="tutorial-content">
<h3>ğŸŒ Windowsç½‘ç»œå®‰å…¨æ£€æŸ¥æŒ‡å—</h3>

<h4>ğŸ“– ç½‘ç»œå®‰å…¨æ£€æŸ¥çš„é‡è¦æ€§</h4>
<p>ç½‘ç»œè¿æ¥æ˜¯æ”»å‡»è€…è¿›å…¥ç³»ç»Ÿå’Œæ•°æ®å¤–æ³„çš„ä¸»è¦é€šé“ã€‚é€šè¿‡ç½‘ç»œæ£€æŸ¥å¯ä»¥å‘ç°åé—¨è¿æ¥ã€å¼‚å¸¸é€šä¿¡å’Œæ½œåœ¨çš„æ•°æ®æ³„éœ²è¡Œä¸ºã€‚</p>

<h4>ğŸ” æ£€æŸ¥è¦ç‚¹</h4>
<ol>
<li><strong>ç½‘ç»œè¿æ¥åˆ†æ</strong> - æ£€æŸ¥æ´»è·ƒçš„ç½‘ç»œè¿æ¥</li>
<li><strong>ç«¯å£ç›‘å¬æ£€æŸ¥</strong> - è¯†åˆ«å¼‚å¸¸çš„ç›‘å¬æœåŠ¡</li>
<li><strong>é˜²ç«å¢™çŠ¶æ€</strong> - æ£€æŸ¥Windowsé˜²ç«å¢™é…ç½®</li>
<li><strong>ç½‘ç»œé…ç½®</strong> - éªŒè¯ç½‘ç»œæ¥å£é…ç½®</li>
<li><strong>DNSè®¾ç½®</strong> - æ£€æŸ¥DNSé…ç½®å®‰å…¨æ€§</li>
</ol>

<h4>ğŸ’» å…³é”®PowerShellå‘½ä»¤</h4>
<div class="command-block">
# 1. æŸ¥çœ‹æ‰€æœ‰ç½‘ç»œè¿æ¥
Get-NetTCPConnection

# 2. æŸ¥çœ‹ç›‘å¬ç«¯å£
Get-NetTCPConnection | Where-Object {$_.State -eq "Listen"}

# 3. æŸ¥çœ‹æ´»è·ƒè¿æ¥
Get-NetTCPConnection | Where-Object {$_.State -eq "Established"}

# 4. æ£€æŸ¥ç½‘ç»œé€‚é…å™¨
Get-NetAdapter

# 5. æŸ¥çœ‹IPé…ç½®
Get-NetIPAddress

# 6. æ£€æŸ¥è·¯ç”±è¡¨
Get-NetRoute

# 7. æŸ¥çœ‹DNSé…ç½®
Get-DnsClientServerAddress

# 8. æ£€æŸ¥é˜²ç«å¢™çŠ¶æ€
Get-NetFirewallProfile

# 9. æŸ¥çœ‹é˜²ç«å¢™è§„åˆ™
Get-NetFirewallRule | Where-Object {$_.Enabled -eq "True"}

# 10. æ£€æŸ¥ç½‘ç»œç»Ÿè®¡
Get-NetAdapterStatistics
</div>

<h4>ğŸš¨ å¯ç–‘ç½‘ç»œæ´»åŠ¨</h4>
<ul>
<li><strong>å¼‚å¸¸å¤–è¿</strong> - è¿æ¥åˆ°å¯ç–‘IPåœ°å€æˆ–åŸŸå</li>
<li><strong>éæ ‡å‡†ç«¯å£</strong> - ä½¿ç”¨å¼‚å¸¸ç«¯å£è¿›è¡Œé€šä¿¡</li>
<li><strong>å¤§é‡è¿æ¥</strong> - å¼‚å¸¸é«˜çš„å¹¶å‘è¿æ¥æ•°</li>
<li><strong>é˜²ç«å¢™å…³é—­</strong> - Windowsé˜²ç«å¢™è¢«ç¦ç”¨</li>
<li><strong>DNSåŠ«æŒ</strong> - DNSè®¾ç½®è¢«æ¶æ„ä¿®æ”¹</li>
</ul>

<h4>ğŸ›¡ï¸ å®‰å…¨å»ºè®®</h4>
<ul>
<li>å¯ç”¨Windowsé˜²ç«å¢™</li>
<li>ç›‘æ§ç½‘ç»œè¿æ¥æ´»åŠ¨</li>
<li>ä½¿ç”¨å®‰å…¨çš„DNSæœåŠ¡å™¨</li>
<li>å®šæœŸæ£€æŸ¥ç½‘ç»œé…ç½®</li>
<li>å®æ–½ç½‘ç»œè®¿é—®æ§åˆ¶</li>
</ul>
</div>
    `,
    
    filesystem: `
<div class="tutorial-content">
<h3>ğŸ“ Windowsæ–‡ä»¶ç³»ç»Ÿå®‰å…¨æ£€æŸ¥æŒ‡å—</h3>

<h4>ğŸ“– æ–‡ä»¶ç³»ç»Ÿæ£€æŸ¥çš„é‡è¦æ€§</h4>
<p>æ–‡ä»¶ç³»ç»Ÿæ˜¯æ”»å‡»è€…æ¤å…¥æ¶æ„æ–‡ä»¶ã€ç¯¡æ”¹ç³»ç»Ÿé…ç½®å’Œå­˜å‚¨çªƒå–æ•°æ®çš„ä¸»è¦ç›®æ ‡ã€‚é€šè¿‡æ–‡ä»¶ç³»ç»Ÿæ£€æŸ¥å¯ä»¥å‘ç°æ¶æ„æ–‡ä»¶å’Œç³»ç»Ÿå®Œæ•´æ€§é—®é¢˜ã€‚</p>

<h4>ğŸ” æ£€æŸ¥è¦ç‚¹</h4>
<ol>
<li><strong>ç³»ç»Ÿæ–‡ä»¶å®Œæ•´æ€§</strong> - æ£€æŸ¥å…³é”®ç³»ç»Ÿæ–‡ä»¶</li>
<li><strong>ä¸´æ—¶ç›®å½•æ£€æŸ¥</strong> - æŸ¥æ‰¾å¯ç–‘çš„ä¸´æ—¶æ–‡ä»¶</li>
<li><strong>ä¸‹è½½ç›®å½•å®¡æŸ¥</strong> - æ£€æŸ¥æœ€è¿‘ä¸‹è½½çš„æ–‡ä»¶</li>
<li><strong>æ–‡ä»¶æƒé™æ£€æŸ¥</strong> - éªŒè¯æ–‡ä»¶æƒé™è®¾ç½®</li>
<li><strong>éšè—æ–‡ä»¶å‘ç°</strong> - æŸ¥æ‰¾éšè—çš„æ¶æ„æ–‡ä»¶</li>
</ol>

<h4>ğŸ’» å…³é”®PowerShellå‘½ä»¤</h4>
<div class="command-block">
# 1. æ£€æŸ¥ç³»ç»Ÿæ–‡ä»¶å®Œæ•´æ€§
sfc /scannow

# 2. æŸ¥æ‰¾æœ€è¿‘ä¿®æ”¹çš„æ–‡ä»¶
Get-ChildItem -Path "C:\Windows\System32" -Recurse | Where-Object {$_.LastWriteTime -gt (Get-Date).AddDays(-7)}

# 3. æ£€æŸ¥ä¸´æ—¶ç›®å½•
Get-ChildItem -Path $env:TEMP -Recurse -Force

# 4. æŸ¥çœ‹ä¸‹è½½ç›®å½•
Get-ChildItem -Path "$env:USERPROFILE\Downloads" | Where-Object {$_.CreationTime -gt (Get-Date).AddDays(-7)}

# 5. æŸ¥æ‰¾å¯æ‰§è¡Œæ–‡ä»¶
Get-ChildItem -Path "C:\" -Recurse -Include "*.exe", "*.bat", "*.cmd", "*.ps1" -ErrorAction SilentlyContinue

# 6. æ£€æŸ¥æ–‡ä»¶æƒé™
Get-Acl -Path "C:\Windows\System32\notepad.exe"

# 7. æŸ¥æ‰¾éšè—æ–‡ä»¶
Get-ChildItem -Path "C:\" -Recurse -Hidden -ErrorAction SilentlyContinue

# 8. æ£€æŸ¥æ–‡ä»¶å“ˆå¸Œ
Get-FileHash -Path "C:\Windows\System32\notepad.exe" -Algorithm SHA256

# 9. æŸ¥æ‰¾å¤§æ–‡ä»¶
Get-ChildItem -Path "C:\" -Recurse | Where-Object {$_.Length -gt 100MB} -ErrorAction SilentlyContinue
</div>

<h4>ğŸš¨ å¯ç–‘æ–‡ä»¶ç‰¹å¾</h4>
<ul>
<li><strong>ä¸´æ—¶ç›®å½•å¯æ‰§è¡Œæ–‡ä»¶</strong> - åœ¨ä¸´æ—¶ç›®å½•ä¸­çš„exeã€batç­‰æ–‡ä»¶</li>
<li><strong>ç³»ç»Ÿç›®å½•å¼‚å¸¸æ–‡ä»¶</strong> - ç³»ç»Ÿç›®å½•ä¸­çš„éç³»ç»Ÿæ–‡ä»¶</li>
<li><strong>æ— ç­¾åæ–‡ä»¶</strong> - ç¼ºå°‘æ•°å­—ç­¾åçš„å¯æ‰§è¡Œæ–‡ä»¶</li>
<li><strong>éšè—å±æ€§æ–‡ä»¶</strong> - å…·æœ‰éšè—å±æ€§çš„å¯ç–‘æ–‡ä»¶</li>
<li><strong>å¼‚å¸¸å¤§å°æ–‡ä»¶</strong> - å¤§å°å¼‚å¸¸çš„ç³»ç»Ÿæ–‡ä»¶</li>
</ul>

<h4>ğŸ›¡ï¸ å®‰å…¨å»ºè®®</h4>
<ul>
<li>å®šæœŸè¿è¡Œç³»ç»Ÿæ–‡ä»¶æ£€æŸ¥</li>
<li>ç›‘æ§å…³é”®ç›®å½•å˜åŒ–</li>
<li>é™åˆ¶ä¸´æ—¶ç›®å½•æ‰§è¡Œæƒé™</li>
<li>ä½¿ç”¨æ–‡ä»¶å®Œæ•´æ€§ç›‘æ§</li>
<li>å®šæœŸæ¸…ç†ä¸´æ—¶æ–‡ä»¶</li>
</ul>
</div>
    `,
    
    registry: `
<div class="tutorial-content">
<h3>ğŸ“‹ Windowsæ³¨å†Œè¡¨å®‰å…¨æ£€æŸ¥æŒ‡å—</h3>

<h4>ğŸ“– æ³¨å†Œè¡¨æ£€æŸ¥çš„é‡è¦æ€§</h4>
<p>Windowsæ³¨å†Œè¡¨æ˜¯ç³»ç»Ÿé…ç½®çš„æ ¸å¿ƒæ•°æ®åº“ã€‚æ”»å‡»è€…ç»å¸¸é€šè¿‡ä¿®æ”¹æ³¨å†Œè¡¨æ¥å®ç°æŒä¹…åŒ–ã€éšè—æ¶æ„è½¯ä»¶å’Œæ”¹å˜ç³»ç»Ÿè¡Œä¸ºã€‚</p>

<h4>ğŸ” æ£€æŸ¥è¦ç‚¹</h4>
<ol>
<li><strong>å¯åŠ¨é¡¹æ³¨å†Œè¡¨</strong> - æ£€æŸ¥è‡ªå¯åŠ¨ç¨‹åºé…ç½®</li>
<li><strong>æœåŠ¡æ³¨å†Œè¡¨</strong> - éªŒè¯ç³»ç»ŸæœåŠ¡é…ç½®</li>
<li><strong>å®‰å…¨ç­–ç•¥</strong> - æ£€æŸ¥å®‰å…¨ç›¸å…³æ³¨å†Œè¡¨é¡¹</li>
<li><strong>æ–‡ä»¶å…³è”</strong> - éªŒè¯æ–‡ä»¶ç±»å‹å…³è”</li>
<li><strong>ç³»ç»Ÿé…ç½®</strong> - æ£€æŸ¥å…³é”®ç³»ç»Ÿé…ç½®é¡¹</li>
</ol>

<h4>ğŸ’» å…³é”®PowerShellå‘½ä»¤</h4>
<div class="command-block">
# 1. æ£€æŸ¥å¯åŠ¨é¡¹æ³¨å†Œè¡¨
Get-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Run"
Get-ItemProperty -Path "HKCU:\SOFTWARE\Microsoft\Windows\CurrentVersion\Run"

# 2. æŸ¥çœ‹RunOnceé¡¹
Get-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce"
Get-ItemProperty -Path "HKCU:\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce"

# 3. æ£€æŸ¥æœåŠ¡æ³¨å†Œè¡¨
Get-ChildItem -Path "HKLM:\SYSTEM\CurrentControlSet\Services"

# 4. æŸ¥çœ‹æœ€è¿‘è¿è¡Œçš„ç¨‹åº
Get-ItemProperty -Path "HKCU:\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\RunMRU"

# 5. æ£€æŸ¥æ–‡ä»¶å…³è”
Get-ItemProperty -Path "HKLM:\SOFTWARE\Classes\.exe"

# 6. æŸ¥çœ‹å®‰è£…çš„ç¨‹åº
Get-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\*"

# 7. æ£€æŸ¥ç½‘ç»œè®¾ç½®
Get-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters"

# 8. æŸ¥çœ‹ç”¨æˆ·é…ç½®æ–‡ä»¶
Get-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\ProfileList\*"
</div>

<h4>ğŸš¨ å¯ç–‘æ³¨å†Œè¡¨é¡¹</h4>
<ul>
<li><strong>å¼‚å¸¸å¯åŠ¨é¡¹</strong> - æŒ‡å‘å¯ç–‘æ–‡ä»¶çš„å¯åŠ¨é¡¹</li>
<li><strong>æœªçŸ¥æœåŠ¡</strong> - ä¸æ˜æ¥æºçš„ç³»ç»ŸæœåŠ¡</li>
<li><strong>ä¿®æ”¹çš„æ–‡ä»¶å…³è”</strong> - è¢«æ¶æ„ä¿®æ”¹çš„æ–‡ä»¶ç±»å‹å…³è”</li>
<li><strong>å¼‚å¸¸ç½‘ç»œé…ç½®</strong> - è¢«ç¯¡æ”¹çš„ç½‘ç»œè®¾ç½®</li>
<li><strong>å®‰å…¨ç­–ç•¥å˜æ›´</strong> - è¢«ä¿®æ”¹çš„å®‰å…¨ç­–ç•¥</li>
</ul>

<h4>ğŸ›¡ï¸ å®‰å…¨å»ºè®®</h4>
<ul>
<li>å®šæœŸå¤‡ä»½æ³¨å†Œè¡¨</li>
<li>ç›‘æ§å…³é”®æ³¨å†Œè¡¨é¡¹å˜åŒ–</li>
<li>ä½¿ç”¨ç»„ç­–ç•¥ç®¡ç†é…ç½®</li>
<li>é™åˆ¶æ³¨å†Œè¡¨ä¿®æ”¹æƒé™</li>
<li>å®¡è®¡æ³¨å†Œè¡¨è®¿é—®</li>
</ul>
</div>
    `,
    
    logs: `
<div class="tutorial-content">
<h3>ğŸ“‹ Windowsæ—¥å¿—åˆ†æå®‰å…¨æ£€æŸ¥æŒ‡å—</h3>

<h4>ğŸ“– æ—¥å¿—åˆ†æçš„é‡è¦æ€§</h4>
<p>Windowsäº‹ä»¶æ—¥å¿—è®°å½•äº†ç³»ç»Ÿçš„æ‰€æœ‰é‡è¦æ´»åŠ¨ã€‚é€šè¿‡ä¸“ä¸šçš„æ—¥å¿—åˆ†æå¯ä»¥å‘ç°æ”»å‡»ç—•è¿¹ã€é‡å»ºæ”»å‡»æ—¶é—´çº¿ï¼Œå¹¶è¯„ä¼°å®‰å…¨äº‹ä»¶çš„å½±å“èŒƒå›´ã€‚</p>

<h4>ğŸ” æ—¥å¿—åˆ†æè¦ç‚¹</h4>
<ol>
<li><strong>å®‰å…¨æ—¥å¿—åˆ†æ</strong> - åˆ†æç™»å½•ã€æƒé™å˜æ›´ç­‰å®‰å…¨äº‹ä»¶</li>
<li><strong>ç³»ç»Ÿæ—¥å¿—æ£€æŸ¥</strong> - æ£€æŸ¥ç³»ç»Ÿé”™è¯¯å’Œå¼‚å¸¸</li>
<li><strong>åº”ç”¨ç¨‹åºæ—¥å¿—</strong> - åˆ†æåº”ç”¨ç¨‹åºç›¸å…³äº‹ä»¶</li>
<li><strong>äº‹ä»¶å…³è”åˆ†æ</strong> - å¤šç»´åº¦å…³è”åˆ†æ</li>
<li><strong>æ—¶é—´çº¿é‡å»º</strong> - æ„å»ºå®Œæ•´çš„äº‹ä»¶æ—¶é—´çº¿</li>
</ol>

<h4>ğŸ’» å…³é”®PowerShellå‘½ä»¤</h4>
<div class="command-block">
# 1. æŸ¥çœ‹ç™»å½•æˆåŠŸäº‹ä»¶
Get-WinEvent -FilterHashtable @{LogName='Security'; ID=4624} -MaxEvents 100

# 2. æŸ¥çœ‹ç™»å½•å¤±è´¥äº‹ä»¶
Get-WinEvent -FilterHashtable @{LogName='Security'; ID=4625} -MaxEvents 100

# 3. æŸ¥çœ‹è´¦æˆ·é”å®šäº‹ä»¶
Get-WinEvent -FilterHashtable @{LogName='Security'; ID=4740} -MaxEvents 50

# 4. æŸ¥çœ‹æƒé™æå‡äº‹ä»¶
Get-WinEvent -FilterHashtable @{LogName='Security'; ID=4672} -MaxEvents 50

# 5. æŸ¥çœ‹ç³»ç»Ÿé”™è¯¯äº‹ä»¶
Get-WinEvent -FilterHashtable @{LogName='System'; Level=2} -MaxEvents 50

# 6. æŸ¥çœ‹åº”ç”¨ç¨‹åºé”™è¯¯
Get-WinEvent -FilterHashtable @{LogName='Application'; Level=2} -MaxEvents 50

# 7. æŸ¥çœ‹æœåŠ¡å¯åŠ¨åœæ­¢äº‹ä»¶
Get-WinEvent -FilterHashtable @{LogName='System'; ID=7034,7035,7036} -MaxEvents 50

# 8. æŸ¥çœ‹è¿›ç¨‹åˆ›å»ºäº‹ä»¶ï¼ˆéœ€è¦å¯ç”¨å®¡è®¡ï¼‰
Get-WinEvent -FilterHashtable @{LogName='Security'; ID=4688} -MaxEvents 100

# 9. æŸ¥çœ‹æ–‡ä»¶è®¿é—®äº‹ä»¶ï¼ˆéœ€è¦å¯ç”¨å®¡è®¡ï¼‰
Get-WinEvent -FilterHashtable @{LogName='Security'; ID=4656,4658} -MaxEvents 50
</div>

<h4>ğŸš¨ å…³é”®å®‰å…¨äº‹ä»¶ID</h4>
<ul>
<li><strong>4624</strong> - è´¦æˆ·æˆåŠŸç™»å½•</li>
<li><strong>4625</strong> - è´¦æˆ·ç™»å½•å¤±è´¥</li>
<li><strong>4648</strong> - ä½¿ç”¨æ˜¾å¼å‡­æ®ç™»å½•</li>
<li><strong>4672</strong> - åˆ†é…äº†ç‰¹æ®Šæƒé™</li>
<li><strong>4688</strong> - æ–°è¿›ç¨‹å·²åˆ›å»º</li>
<li><strong>4740</strong> - ç”¨æˆ·è´¦æˆ·è¢«é”å®š</li>
<li><strong>4756</strong> - æˆå‘˜å·²æ·»åŠ åˆ°å®‰å…¨ç»„</li>
<li><strong>4720</strong> - ç”¨æˆ·è´¦æˆ·å·²åˆ›å»º</li>
</ul>

<h4>ğŸ”§ æ—¥å¿—åˆ†ææŠ€å·§</h4>
<ol>
<li><strong>æ—¶é—´å…³è”</strong> - åˆ†æäº‹ä»¶å‘ç”Ÿçš„æ—¶é—´æ¨¡å¼</li>
<li><strong>ç”¨æˆ·è¡Œä¸º</strong> - åˆ†æç”¨æˆ·æ´»åŠ¨æ¨¡å¼</li>
<li><strong>IPåœ°å€åˆ†æ</strong> - è¯†åˆ«å¼‚å¸¸æ¥æºIP</li>
<li><strong>å¤±è´¥æ¨¡å¼</strong> - åˆ†æç™»å½•å¤±è´¥çš„æ¨¡å¼</li>
<li><strong>æƒé™å˜æ›´</strong> - ç›‘æ§æƒé™æå‡äº‹ä»¶</li>
</ol>

<h4>ğŸ›¡ï¸ æ—¥å¿—å®‰å…¨å»ºè®®</h4>
<ul>
<li>å¯ç”¨è¯¦ç»†çš„å®‰å…¨å®¡è®¡</li>
<li>å®šæœŸåˆ†æå®‰å…¨æ—¥å¿—</li>
<li>è®¾ç½®æ—¥å¿—å‘Šè­¦è§„åˆ™</li>
<li>ä¿æŠ¤æ—¥å¿—æ–‡ä»¶å®‰å…¨</li>
<li>å»ºç«‹æ—¥å¿—å¤‡ä»½ç­–ç•¥</li>
</ul>
</div>
    `,
    
    tasks: `
<div class="tutorial-content">
<h3>â° Windowsè®¡åˆ’ä»»åŠ¡å®‰å…¨æ£€æŸ¥æŒ‡å—</h3>

<h4>ğŸ“– è®¡åˆ’ä»»åŠ¡æ£€æŸ¥çš„é‡è¦æ€§</h4>
<p>Windowsè®¡åˆ’ä»»åŠ¡æ˜¯æ”»å‡»è€…å®ç°æŒä¹…åŒ–çš„å¸¸ç”¨æ–¹æ³•ã€‚æ¶æ„çš„è®¡åˆ’ä»»åŠ¡å¯ä»¥åœ¨ç³»ç»Ÿå¯åŠ¨æ—¶æˆ–ç‰¹å®šæ—¶é—´æ‰§è¡Œæ¶æ„ä»£ç ï¼Œç»´æŒå¯¹ç³»ç»Ÿçš„æ§åˆ¶ã€‚</p>

<h4>ğŸ” æ£€æŸ¥è¦ç‚¹</h4>
<ol>
<li><strong>ä»»åŠ¡åˆæ³•æ€§</strong> - éªŒè¯è®¡åˆ’ä»»åŠ¡çš„åˆæ³•æ€§</li>
<li><strong>æ‰§è¡Œæƒé™</strong> - æ£€æŸ¥ä»»åŠ¡çš„æ‰§è¡Œæƒé™</li>
<li><strong>è§¦å‘æ¡ä»¶</strong> - åˆ†æä»»åŠ¡çš„è§¦å‘æ¡ä»¶</li>
<li><strong>æ‰§è¡Œå†…å®¹</strong> - æ£€æŸ¥ä»»åŠ¡æ‰§è¡Œçš„å‘½ä»¤æˆ–è„šæœ¬</li>
<li><strong>åˆ›å»ºæ—¶é—´</strong> - å…³æ³¨ä»»åŠ¡çš„åˆ›å»ºæ—¶é—´</li>
</ol>

<h4>ğŸ’» å…³é”®PowerShellå‘½ä»¤</h4>
<div class="command-block">
# 1. æŸ¥çœ‹æ‰€æœ‰è®¡åˆ’ä»»åŠ¡
Get-ScheduledTask

# 2. æŸ¥çœ‹è¿è¡Œä¸­çš„ä»»åŠ¡
Get-ScheduledTask | Where-Object {$_.State -eq "Running"}

# 3. æŸ¥çœ‹å°±ç»ªçŠ¶æ€çš„ä»»åŠ¡
Get-ScheduledTask | Where-Object {$_.State -eq "Ready"}

# 4. è·å–ä»»åŠ¡è¯¦ç»†ä¿¡æ¯
Get-ScheduledTaskInfo -TaskName "TaskName"

# 5. æŸ¥çœ‹ä»»åŠ¡çš„æ“ä½œ
Get-ScheduledTask | Select-Object TaskName, Actions

# 6. æŸ¥çœ‹ä»»åŠ¡çš„è§¦å‘å™¨
Get-ScheduledTask | Select-Object TaskName, Triggers

# 7. æŸ¥çœ‹ç‰¹å®šè·¯å¾„ä¸‹çš„ä»»åŠ¡
Get-ScheduledTask -TaskPath "\Microsoft\Windows\*"

# 8. å¯¼å‡ºä»»åŠ¡é…ç½®
Export-ScheduledTask -TaskName "TaskName"

# 9. æŸ¥çœ‹ä»»åŠ¡å†å²
Get-WinEvent -FilterHashtable @{LogName='Microsoft-Windows-TaskScheduler/Operational'} -MaxEvents 100
</div>

<h4>ğŸš¨ å¯ç–‘ä»»åŠ¡ç‰¹å¾</h4>
<ul>
<li><strong>å¼‚å¸¸æ‰§è¡Œè·¯å¾„</strong> - æ‰§è¡Œä¸´æ—¶ç›®å½•æˆ–ç”¨æˆ·ç›®å½•ä¸­çš„æ–‡ä»¶</li>
<li><strong>å¯ç–‘å‘½ä»¤</strong> - æ‰§è¡ŒPowerShellã€cmdç­‰å‘½ä»¤è¡Œå·¥å…·</li>
<li><strong>é«˜æƒé™æ‰§è¡Œ</strong> - ä»¥SYSTEMæƒé™è¿è¡Œçš„å¯ç–‘ä»»åŠ¡</li>
<li><strong>é¢‘ç¹è§¦å‘</strong> - å¼‚å¸¸é¢‘ç¹çš„è§¦å‘æ¡ä»¶</li>
<li><strong>éšè—ä»»åŠ¡</strong> - åœ¨éæ ‡å‡†ä½ç½®çš„ä»»åŠ¡</li>
</ul>

<h4>ğŸ”§ åˆ†ææŠ€å·§</h4>
<ol>
<li><strong>æ—¶é—´å…³è”</strong> - å°†ä»»åŠ¡åˆ›å»ºæ—¶é—´ä¸å®‰å…¨äº‹ä»¶å…³è”</li>
<li><strong>æƒé™åˆ†æ</strong> - æ£€æŸ¥ä»»åŠ¡çš„æ‰§è¡Œæƒé™</li>
<li><strong>å†…å®¹åˆ†æ</strong> - åˆ†æä»»åŠ¡æ‰§è¡Œçš„è„šæœ¬å†…å®¹</li>
<li><strong>ç½‘ç»œæ´»åŠ¨</strong> - æ£€æŸ¥ä»»åŠ¡æ˜¯å¦æœ‰ç½‘ç»œæ´»åŠ¨</li>
<li><strong>æ–‡ä»¶ä¾èµ–</strong> - åˆ†æä»»åŠ¡ä¾èµ–çš„æ–‡ä»¶</li>
</ol>

<h4>ğŸ›¡ï¸ å®‰å…¨å»ºè®®</h4>
<ul>
<li>å®šæœŸå®¡æŸ¥è®¡åˆ’ä»»åŠ¡</li>
<li>é™åˆ¶ä»»åŠ¡åˆ›å»ºæƒé™</li>
<li>ç›‘æ§ä»»åŠ¡æ‰§è¡Œæ—¥å¿—</li>
<li>ä½¿ç”¨ç»„ç­–ç•¥ç®¡ç†ä»»åŠ¡</li>
<li>å»ºç«‹ä»»åŠ¡ç™½åå•</li>
</ul>
</div>
    `,
    
    malware: `
<div class="tutorial-content">
<h3>ğŸ¦  Windowsæ¶æ„è½¯ä»¶æ£€æµ‹æŒ‡å—</h3>

<h4>ğŸ“– æ¶æ„è½¯ä»¶æ£€æµ‹çš„é‡è¦æ€§</h4>
<p>æ¶æ„è½¯ä»¶æ˜¯Windowsç³»ç»Ÿé¢ä¸´çš„ä¸»è¦å¨èƒä¹‹ä¸€ã€‚åŠæ—¶å‘ç°å’Œæ¸…é™¤æ¶æ„è½¯ä»¶å¯¹äºä¿æŠ¤ç³»ç»Ÿå®‰å…¨å’Œæ•°æ®å®Œæ•´æ€§è‡³å…³é‡è¦ã€‚</p>

<h4>ğŸ” æ£€æµ‹è¦ç‚¹</h4>
<ol>
<li><strong>é˜²ç—…æ¯’çŠ¶æ€</strong> - æ£€æŸ¥Windows Defenderç­‰é˜²ç—…æ¯’è½¯ä»¶çŠ¶æ€</li>
<li><strong>è¿›ç¨‹è¡Œä¸º</strong> - åˆ†æå¯ç–‘è¿›ç¨‹çš„è¡Œä¸ºç‰¹å¾</li>
<li><strong>ç½‘ç»œè¿æ¥</strong> - æ£€æµ‹å¼‚å¸¸çš„ç½‘ç»œé€šä¿¡</li>
<li><strong>æ–‡ä»¶ç‰¹å¾</strong> - è¯†åˆ«æ¶æ„æ–‡ä»¶ç‰¹å¾</li>
<li><strong>ç³»ç»Ÿå˜æ›´</strong> - ç›‘æ§ç³»ç»Ÿé…ç½®å˜æ›´</li>
</ol>

<h4>ğŸ’» å…³é”®PowerShellå‘½ä»¤</h4>
<div class="command-block">
# 1. æ£€æŸ¥Windows DefenderçŠ¶æ€
Get-MpComputerStatus

# 2. æŸ¥çœ‹å¨èƒæ£€æµ‹å†å²
Get-MpThreatDetection

# 3. è¿è¡Œå¿«é€Ÿæ‰«æ
Start-MpScan -ScanType QuickScan

# 4. æŸ¥çœ‹æ’é™¤é¡¹
Get-MpPreference | Select-Object ExclusionPath, ExclusionProcess

# 5. æ£€æŸ¥å®æ—¶ä¿æŠ¤çŠ¶æ€
Get-MpComputerStatus | Select-Object RealTimeProtectionEnabled

# 6. æŸ¥çœ‹å¯ç–‘ç½‘ç»œè¿æ¥
Get-NetTCPConnection | Where-Object {$_.RemoteAddress -notmatch "^(127\.|10\.|172\.(1[6-9]|2[0-9]|3[01])\.|192\.168\.)"}

# 7. æ£€æŸ¥å¼‚å¸¸è¿›ç¨‹
Get-Process | Where-Object {$_.ProcessName -match "^[a-f0-9]{8,}$"}

# 8. æŸ¥çœ‹ç­¾åçŠ¶æ€
Get-ChildItem -Path "C:\Windows\System32\*.exe" | Get-AuthenticodeSignature | Where-Object {$_.Status -ne "Valid"}

# 9. æ£€æŸ¥å¯åŠ¨é¡¹
Get-CimInstance -ClassName Win32_StartupCommand | Where-Object {$_.Command -match "(temp|tmp|appdata)"}
</div>

<h4>ğŸš¨ æ¶æ„è½¯ä»¶ç‰¹å¾</h4>
<ul>
<li><strong>é˜²ç—…æ¯’è¢«ç¦ç”¨</strong> - Windows Defenderæˆ–å…¶ä»–é˜²ç—…æ¯’è½¯ä»¶è¢«å…³é—­</li>
<li><strong>å¼‚å¸¸ç½‘ç»œè¿æ¥</strong> - è¿æ¥åˆ°å¯ç–‘IPæˆ–åŸŸå</li>
<li><strong>æ— ç­¾åæ–‡ä»¶</strong> - ç¼ºå°‘æ•°å­—ç­¾åçš„å¯æ‰§è¡Œæ–‡ä»¶</li>
<li><strong>å¼‚å¸¸è¿›ç¨‹å</strong> - éšæœºå­—ç¬¦å‘½åçš„è¿›ç¨‹</li>
<li><strong>é«˜èµ„æºå ç”¨</strong> - å¼‚å¸¸é«˜çš„CPUæˆ–ç½‘ç»œä½¿ç”¨</li>
</ul>

<h4>ğŸ”§ æ£€æµ‹æŠ€å·§</h4>
<ol>
<li><strong>è¡Œä¸ºåˆ†æ</strong> - ç›‘æ§è¿›ç¨‹çš„å¼‚å¸¸è¡Œä¸º</li>
<li><strong>ç½‘ç»œç›‘æ§</strong> - åˆ†æç½‘ç»œæµé‡æ¨¡å¼</li>
<li><strong>æ–‡ä»¶åˆ†æ</strong> - æ£€æŸ¥æ–‡ä»¶çš„å“ˆå¸Œå€¼å’Œç­¾å</li>
<li><strong>å†…å­˜åˆ†æ</strong> - åˆ†æå†…å­˜ä¸­çš„æ¶æ„ä»£ç </li>
<li><strong>æ²™ç®±åˆ†æ</strong> - åœ¨éš”ç¦»ç¯å¢ƒä¸­åˆ†æå¯ç–‘æ–‡ä»¶</li>
</ol>

<h4>ğŸ›¡ï¸ é˜²æŠ¤å»ºè®®</h4>
<ul>
<li>ä¿æŒWindows Defenderå¯ç”¨</li>
<li>å®šæœŸæ›´æ–°ç—…æ¯’å®šä¹‰</li>
<li>ä½¿ç”¨åº”ç”¨ç¨‹åºç™½åå•</li>
<li>ç›‘æ§ç³»ç»Ÿè¡Œä¸ºå˜åŒ–</li>
<li>å®šæœŸè¿›è¡Œå…¨ç›˜æ‰«æ</li>
</ul>
</div>
    `
  };
  
  return tutorials[category] || '<p>è¯¥æ¨¡å—çš„æ•™ç¨‹æ­£åœ¨å®Œå–„ä¸­...</p>';
}

// æ–‡ä»¶ä¸Šä¼ å¤„ç†
document.addEventListener('DOMContentLoaded', function() {
  const fileInput = document.getElementById('fileInput');
  if (fileInput) {
    fileInput.addEventListener('change', function(e) {
  const file = e.target.files[0];
  if (file) {
    // æ˜¾ç¤ºä¸Šä¼ è¿›åº¦
    showAlert('æ­£åœ¨åˆ†ææ–‡ä»¶ï¼Œè¯·ç¨å€™...', 'info');
    
    // ä½¿ç”¨FormDataä¸Šä¼ æ–‡ä»¶åˆ°åç«¯API
    const formData = new FormData();
    formData.append('file', file);
    
    fetch('/analyze', {
      method: 'POST',
      body: formData
    })
    .then(response => response.json())
    .then(result => {
      if (result.success) {
        // å¤„ç†åˆ†æç»“æœ
        processAnalysisResult(result);
        
        // åŒæ—¶è¯»å–æ–‡ä»¶å†…å®¹ç”¨äºæ˜¾ç¤ºï¼Œä½†ä¸é‡æ–°åˆ†æ
        const reader = new FileReader();
        reader.onload = function(e) {
          gContent = e.target.result;
          parseAndRenderReport(gContent, true); // ä¼ é€’å‚æ•°è¡¨ç¤ºå·²ç»åˆ†æè¿‡äº†
        };
        reader.readAsText(file);
      } else {
        showAlert('æ–‡ä»¶åˆ†æå¤±è´¥: ' + (result.error || 'æœªçŸ¥é”™è¯¯'), 'error');
      }
    })
    .catch(error => {
      console.error('åˆ†æé”™è¯¯:', error);
      showAlert('æ–‡ä»¶åˆ†æå¤±è´¥: ' + error.message, 'error');
      
      // å¦‚æœAPIå¤±è´¥ï¼Œä»ç„¶å°è¯•æœ¬åœ°è§£æ
      const reader = new FileReader();
      reader.onload = function(e) {
        gContent = e.target.result;
        parseAndRenderReport(gContent);
      };
      reader.readAsText(file);
    });
  }
    });
  }
});

// å¤„ç†åˆ†æç»“æœ
function processAnalysisResult(result) {
  // æ›´æ–°å‘Šè­¦é¢æ¿
  updateAlertsPanel(result.alerts, result.recommendations);
  
  // æ˜¾ç¤ºåˆ†æå®Œæˆæ¶ˆæ¯
  const alertCount = result.alerts ? result.alerts.length : 0;
  const riskLevel = alertCount > 5 ? 'é«˜é£é™©' : alertCount > 2 ? 'ä¸­ç­‰é£é™©' : 'ä½é£é™©';
  showAlert(`åˆ†æå®Œæˆï¼å‘ç° ${alertCount} ä¸ªå®‰å…¨å‘Šè­¦ï¼Œé£é™©ç­‰çº§ï¼š${riskLevel}`, 'success');
}

// æ›´æ–°å‘Šè­¦é¢æ¿
function updateAlertsPanel(alerts, recommendations) {
  const alertsContainer = document.getElementById('alertContainer');
  if (!alertsContainer) return;
  
  let alertsHtml = '';
  
  if (alerts && alerts.length > 0) {
    // æŒ‰ä¸¥é‡ç¨‹åº¦åˆ†ç»„
    const alertsBySeverity = {
      high: alerts.filter(a => a.severity === 'high'),
      medium: alerts.filter(a => a.severity === 'medium'),
      low: alerts.filter(a => a.severity === 'low')
    };
    
    // æ˜¾ç¤ºé«˜å±å‘Šè­¦
    if (alertsBySeverity.high.length > 0) {
      alertsHtml += `<div class="alert-group high-risk">
        <h4>ğŸš¨ é«˜å±å‘Šè­¦ (${alertsBySeverity.high.length})</h4>`;
      alertsBySeverity.high.forEach(alert => {
        alertsHtml += `<div class="alert-item">
          <strong>${alert.rule_name}</strong><br>
          <span class="alert-desc">${alert.description}</span><br>
          <small>è¡Œå·: ${alert.line_number} | ç±»åˆ«: ${alert.category}</small>
        </div>`;
      });
      alertsHtml += '</div>';
    }
    
    // æ˜¾ç¤ºä¸­å±å‘Šè­¦
    if (alertsBySeverity.medium.length > 0) {
      alertsHtml += `<div class="alert-group medium-risk">
        <h4>âš ï¸ ä¸­å±å‘Šè­¦ (${alertsBySeverity.medium.length})</h4>`;
      alertsBySeverity.medium.forEach(alert => {
        alertsHtml += `<div class="alert-item">
          <strong>${alert.rule_name}</strong><br>
          <span class="alert-desc">${alert.description}</span><br>
          <small>è¡Œå·: ${alert.line_number} | ç±»åˆ«: ${alert.category}</small>
        </div>`;
      });
      alertsHtml += '</div>';
    }
    
    // æ˜¾ç¤ºå¤„ç½®å»ºè®®
    if (recommendations && recommendations.length > 0) {
      alertsHtml += `<div class="recommendations">
        <h4>ğŸ’¡ å¤„ç½®å»ºè®®</h4>`;
      recommendations.forEach(rec => {
        alertsHtml += `<div class="recommendation-item">
          <h5>${rec.category} (${rec.priority}ä¼˜å…ˆçº§)</h5>
          <ul>`;
        rec.actions.forEach(action => {
          alertsHtml += `<li>${action}</li>`;
        });
        alertsHtml += '</ul>';
        
        if (rec.emergency_actions && rec.emergency_actions.length > 0) {
          alertsHtml += '<div class="emergency-actions"><strong>ç´§æ€¥æªæ–½ï¼š</strong><ul>';
          rec.emergency_actions.forEach(action => {
            alertsHtml += `<li>${action}</li>`;
          });
          alertsHtml += '</ul></div>';
        }
        alertsHtml += '</div>';
      });
      alertsHtml += '</div>';
    }
  } else {
    alertsHtml = '<div class="no-alerts">âœ… æœªå‘ç°å®‰å…¨å‘Šè­¦ï¼Œç³»ç»ŸçŠ¶æ€è‰¯å¥½</div>';
  }
  
  alertsContainer.innerHTML = alertsHtml;
}

// æ˜¾ç¤ºæç¤ºæ¶ˆæ¯
function showAlert(message, type = 'info') {
  // åˆ›å»ºæç¤ºå…ƒç´ 
  const alertDiv = document.createElement('div');
  alertDiv.className = `alert alert-${type}`;
  alertDiv.innerHTML = `
    <span>${message}</span>
    <button onclick="this.parentElement.remove()">Ã—</button>
  `;
  
  // æ·»åŠ åˆ°é¡µé¢é¡¶éƒ¨
  document.body.insertBefore(alertDiv, document.body.firstChild);
  
  // 3ç§’åè‡ªåŠ¨æ¶ˆå¤±
  setTimeout(() => {
    if (alertDiv.parentElement) {
      alertDiv.remove();
    }
  }, 3000);
}

// è§£æå¹¶æ¸²æŸ“æŠ¥å‘Š
function parseAndRenderReport(content, skipAnalysis = false) {
  const data = {};
  
  // è§£æWindowsæŠ¥å‘Šå†…å®¹
  const sections = content.split(/={60,}/);
  
  sections.forEach(section => {
    const lines = section.trim().split('\n');
    if (lines.length > 0) {
      const title = lines[0].trim();
      
      // æ˜ å°„åˆ°å¯¹åº”çš„æ ‡ç­¾ - æ›´æ–°ä¸ºæ–°çš„æŠ¥å‘Šæ ¼å¼
      if (title.includes('ç³»ç»ŸåŸºæœ¬ä¿¡æ¯') || title.includes('ç³»ç»Ÿä¿¡æ¯')) {
        data.system = parseSystemSection(section);
      } else if (title.includes('ç”¨æˆ·è´¦æˆ·ä¿¡æ¯') || title.includes('ç”¨æˆ·å’Œæƒé™')) {
        data.user = parseUserSection(section);
      } else if (title.includes('è¿›ç¨‹ä¿¡æ¯') || title.includes('è¿›ç¨‹å’ŒæœåŠ¡')) {
        data.process = parseProcessSection(section);
      } else if (title.includes('ç½‘ç»œè¿æ¥ä¿¡æ¯') || title.includes('ç½‘ç»œè¿æ¥')) {
        data.network = parseNetworkSection(section);
      } else if (title.includes('æ–‡ä»¶ç³»ç»Ÿæ£€æŸ¥') || title.includes('æ–‡ä»¶ç³»ç»Ÿ')) {
        data.filesystem = parseFilesystemSection(section);
      } else if (title.includes('æ³¨å†Œè¡¨å¯åŠ¨é¡¹æ£€æŸ¥') || title.includes('æ³¨å†Œè¡¨')) {
        data.registry = parseRegistrySection(section);
      } else if (title.includes('ç³»ç»Ÿæ—¥å¿—æ‘˜è¦') || title.includes('æ—¥å¿—åˆ†æ')) {
        data.logs = parseLogsSection(section);
      } else if (title.includes('è®¡åˆ’ä»»åŠ¡æ£€æŸ¥') || title.includes('è®¡åˆ’ä»»åŠ¡')) {
        data.tasks = parseTasksSection(section);
      } else if (title.includes('Windows DefenderçŠ¶æ€') || title.includes('æ¶æ„è½¯ä»¶')) {
        data.malware = parseMalwareSection(section);
      } else if (title.includes('å·²å®‰è£…è¡¥ä¸ä¿¡æ¯')) {
        data.patches = parseSystemSection(section);
      } else if (title.includes('é‡è¦ç¯å¢ƒå˜é‡')) {
        data.environment = parseSystemSection(section);
      } else if (title.includes('ç³»ç»ŸæœåŠ¡æ£€æŸ¥')) {
        data.services = parseSystemSection(section);
      } else if (title.includes('å¯åŠ¨é¡¹æ£€æŸ¥')) {
        data.startup = parseSystemSection(section);
      } else if (title.includes('æœ€è¿‘è®¿é—®æ–‡ä»¶è®°å½•')) {
        data.recent_files = parseSystemSection(section);
      } else if (title.includes('å®‰å…¨ç»Ÿè®¡æ±‡æ€»')) {
        data.stats = parseStatsSection(section);
      }
    }
  });
  
  // ç”Ÿæˆæ¦‚è§ˆæ•°æ®
  data.summary = generateSummaryContent(data);
  data.guide = generateGuideContent();
  
  renderTabs(data);
}

// è§£æå„ä¸ªéƒ¨åˆ†çš„å‡½æ•°
function parseSystemSection(content) {
  const result = {};
  
  // é¦–å…ˆå°è¯•æŒ‰ç…§æ–°æ ¼å¼è§£æï¼ˆä½¿ç”¨å†’å·åˆ†éš”çš„é”®å€¼å¯¹ï¼‰
  const lines = content.split('\n');
  let currentKey = '';
  let currentContent = [];
  
  for (let i = 0; i < lines.length; i++) {
    const line = lines[i].trim();
    
    // è·³è¿‡åˆ†éš”çº¿å’Œç©ºè¡Œ
    if (!line || line.match(/^={3,}/) || line.match(/^-{3,}/)) {
      continue;
    }
    
    // æ£€æŸ¥æ˜¯å¦æ˜¯æ–°çš„é”®ï¼ˆåŒ…å«å†’å·çš„è¡Œï¼‰
    if (line.includes(':') && !line.startsWith('-') && !line.startsWith('â€¢')) {
      // ä¿å­˜ä¹‹å‰çš„å†…å®¹
      if (currentKey && currentContent.length > 0) {
        result[currentKey] = currentContent.join('\n').trim();
      }
      
      // å¼€å§‹æ–°çš„é”®
      const colonIndex = line.indexOf(':');
      currentKey = line.substring(0, colonIndex).trim();
      const value = line.substring(colonIndex + 1).trim();
      currentContent = value ? [value] : [];
    } else if (currentKey) {
      // æ·»åŠ åˆ°å½“å‰å†…å®¹
      currentContent.push(line);
    } else if (line && !result['å†…å®¹']) {
      // å¦‚æœæ²¡æœ‰æ˜ç¡®çš„é”®ï¼Œä½¿ç”¨"å†…å®¹"ä½œä¸ºé»˜è®¤é”®
      result['å†…å®¹'] = result['å†…å®¹'] ? result['å†…å®¹'] + '\n' + line : line;
    }
  }
  
  // ä¿å­˜æœ€åä¸€ä¸ªé”®çš„å†…å®¹
  if (currentKey && currentContent.length > 0) {
    result[currentKey] = currentContent.join('\n').trim();
  }
  
  // å¦‚æœæ²¡æœ‰è§£æåˆ°ä»»ä½•é”®å€¼å¯¹ï¼Œå°†æ•´ä¸ªå†…å®¹ä½œä¸ºä¸€ä¸ªå—
  if (Object.keys(result).length === 0) {
    result['è¯¦ç»†ä¿¡æ¯'] = content.trim();
  }
  
  return result;
}

function parseUserSection(content) {
  return parseSystemSection(content);
}

function parseProcessSection(content) {
  return parseSystemSection(content);
}

function parseNetworkSection(content) {
  return parseSystemSection(content);
}

function parseFilesystemSection(content) {
  return parseSystemSection(content);
}

function parseRegistrySection(content) {
  return parseSystemSection(content);
}

function parseLogsSection(content) {
  return parseSystemSection(content);
}

function parseTasksSection(content) {
  return parseSystemSection(content);
}

function parseMalwareSection(content) {
  return parseSystemSection(content);
}

function parseStatsSection(content) {
  return parseSystemSection(content);
}

function parseGuideSection(content) {
  return parseSystemSection(content);
}

// ç”Ÿæˆæ¦‚è§ˆå†…å®¹
function generateSummaryContent(data) {
  let summary = "Windowsç³»ç»Ÿåº”æ€¥å“åº”æŠ¥å‘Šæ¦‚è§ˆ\n\n";
  
  // ç»Ÿè®¡ä¿¡æ¯
  summary += "æ£€æŸ¥æ¨¡å—ç»Ÿè®¡:\n";
  Object.keys(data).forEach(key => {
    if (key !== 'summary') {
      const moduleData = data[key];
      const itemCount = Object.keys(moduleData || {}).length;
      summary += `- ${TAB_TITLES[key]}: ${itemCount} ä¸ªæ£€æŸ¥é¡¹\n`;
    }
  });
  
  summary += "\nå®‰å…¨çŠ¶å†µè¯„ä¼°:\n";
  summary += "- ç³»ç»Ÿä¿¡æ¯: å·²æ”¶é›†\n";
  summary += "- ç”¨æˆ·æƒé™: å·²æ£€æŸ¥\n";
  summary += "- è¿›ç¨‹æœåŠ¡: å·²åˆ†æ\n";
  summary += "- ç½‘ç»œè¿æ¥: å·²ç›‘æ§\n";
  summary += "- æ–‡ä»¶ç³»ç»Ÿ: å·²æ‰«æ\n";
  summary += "- æ³¨å†Œè¡¨: å·²å®¡æŸ¥\n";
  summary += "- ç³»ç»Ÿæ—¥å¿—: å·²åˆ†æ\n";
  summary += "- è®¡åˆ’ä»»åŠ¡: å·²æ£€æŸ¥\n";
  summary += "- æ¶æ„è½¯ä»¶: å·²æ£€æµ‹\n";
  
  return {
    "ç³»ç»Ÿæ¦‚è§ˆ": summary,
    "é£é™©è¯„ä¼°": "åŸºäºæ£€æŸ¥ç»“æœè¿›è¡Œé£é™©è¯„ä¼°...",
    "æ™ºèƒ½å»ºè®®": "æ ¹æ®å‘ç°çš„é—®é¢˜æä¾›å¤„ç½®å»ºè®®...",
    "æ£€æŸ¥æ¸…å•": "Windowså®‰å…¨æ£€æŸ¥æ¸…å•...",
    "ä¸“ä¸šæ€»ç»“": "åŸºäºNISTæ¡†æ¶çš„ä¸“ä¸šåˆ†ææ€»ç»“..."
  };
}

// ç”Ÿæˆåº”æ€¥æŒ‡å—å†…å®¹
function generateGuideContent() {
  return {
    "ğŸ¯ åº”æ€¥å“åº”æµç¨‹": `
Windowsåº”æ€¥å“åº”å®Œæ•´æµç¨‹æŒ‡å—

ğŸ“‹ é˜¶æ®µ1ï¼šå‡†å¤‡é˜¶æ®µï¼ˆå¹³æ—¶å‡†å¤‡ï¼‰
â–¡ å»ºç«‹åº”æ€¥å“åº”å›¢é˜Ÿå’Œè”ç³»æ–¹å¼
â–¡ å‡†å¤‡åº”æ€¥å“åº”å·¥å…·å’Œè„šæœ¬
â–¡ åˆ¶å®šåº”æ€¥å“åº”é¢„æ¡ˆå’Œæµç¨‹
â–¡ å®šæœŸè¿›è¡Œåº”æ€¥æ¼”ç»ƒ
â–¡ å»ºç«‹ç³»ç»ŸåŸºçº¿å’Œç›‘æ§

ğŸ” é˜¶æ®µ2ï¼šè¯†åˆ«é˜¶æ®µï¼ˆå‘ç°é—®é¢˜ï¼‰
1. æ”¶é›†å‘Šè­¦ä¿¡æ¯å’Œå¼‚å¸¸ç°è±¡
2. åˆæ­¥åˆ¤æ–­æ˜¯å¦ä¸ºå®‰å…¨äº‹ä»¶
3. ç¡®å®šå½±å“èŒƒå›´å’Œä¸¥é‡ç¨‹åº¦
4. å¯åŠ¨åº”æ€¥å“åº”æµç¨‹
5. é€šçŸ¥ç›¸å…³äººå‘˜å’Œç®¡ç†å±‚

ğŸš« é˜¶æ®µ3ï¼šéåˆ¶é˜¶æ®µï¼ˆæ§åˆ¶å½±å“ï¼‰
ç«‹å³æªæ–½ï¼š
â–¡ éš”ç¦»å—å½±å“ç³»ç»Ÿï¼ˆæ–­ç½‘ä½†ä¸å…³æœºï¼‰
â–¡ é˜»æ–­å¯ç–‘ç½‘ç»œè¿æ¥
â–¡ ç¦ç”¨å¯ç–‘ç”¨æˆ·è´¦æˆ·
â–¡ åœæ­¢å¯ç–‘è¿›ç¨‹å’ŒæœåŠ¡

çŸ­æœŸæªæ–½ï¼š
â–¡ ä¿®æ”¹æ‰€æœ‰è´¦æˆ·å¯†ç 
â–¡ æ›´æ–°å®‰å…¨ç­–ç•¥å’Œè§„åˆ™
â–¡ åŠ å¼ºç›‘æ§å’Œæ—¥å¿—è®°å½•
â–¡ éƒ¨ç½²ä¸´æ—¶å®‰å…¨æªæ–½

ğŸ§¹ é˜¶æ®µ4ï¼šæ ¹é™¤é˜¶æ®µï¼ˆæ¸…é™¤å¨èƒï¼‰
1. æ·±åº¦æ‰«æå’Œåˆ†æ
2. æ¸…é™¤æ¶æ„ä»£ç 
3. ç³»ç»ŸåŠ å›º

ğŸ”„ é˜¶æ®µ5ï¼šæ¢å¤é˜¶æ®µï¼ˆæ¢å¤ä¸šåŠ¡ï¼‰
1. ç³»ç»ŸéªŒè¯
2. é€æ­¥æ¢å¤
3. æŒç»­ç›‘æ§

ğŸ“ é˜¶æ®µ6ï¼šæ€»ç»“é˜¶æ®µï¼ˆç»éªŒæ•™è®­ï¼‰
1. äº‹ä»¶åˆ†ææŠ¥å‘Š
2. æ”¹è¿›æªæ–½
3. é¢„é˜²æªæ–½
`,
    "ğŸ” åˆ¤æ–­æŠ€å·§å¤§å…¨": `
Windowsåº”æ€¥å“åº”åˆ¤æ–­æŠ€å·§ï¼ˆå¤§ç™½è¯ç‰ˆï¼‰

ğŸ‘¥ ç”¨æˆ·è´¦æˆ·å®‰å…¨åˆ¤æ–­

ğŸš¨ é«˜å±ä¿¡å·ï¼š
âœ— å‘ç°é™¤äº†Administratorå¤–è¿˜æœ‰å…¶ä»–ç®¡ç†å‘˜è´¦æˆ·
âœ— æœ‰ç”¨æˆ·çš„SIDæ˜¯500ï¼ˆè¶…çº§ç®¡ç†å‘˜æƒé™ï¼‰
âœ— å‘ç°ä»æœªç™»å½•ä½†å¯ç”¨çš„è´¦æˆ·
âœ— æœ€è¿‘æ–°å¢çš„å¯ç–‘ç”¨æˆ·è´¦æˆ·

âœ… æ­£å¸¸æƒ…å†µï¼š
âœ“ åªæœ‰Administratorä¸€ä¸ªç®¡ç†å‘˜è´¦æˆ·
âœ“ æ™®é€šç”¨æˆ·éƒ½æœ‰æ­£å¸¸çš„ç™»å½•è®°å½•
âœ“ ç”¨æˆ·æƒé™åˆ†é…åˆç†ï¼Œéµå¾ªæœ€å°æƒé™åŸåˆ™
âœ“ æ²¡æœ‰å¼‚å¸¸çš„æƒé™æå‡

ğŸ’¡ åˆ¤æ–­æŠ€å·§ï¼š
1. "ç®¡ç†å‘˜è¶Šå°‘è¶Šå®‰å…¨" - ç®¡ç†å‘˜è´¦æˆ·åº”è¯¥æ§åˆ¶åœ¨æœ€å°‘æ•°é‡
2. "é™Œç”Ÿè´¦æˆ·è¦æ€€ç–‘" - ä¸è®¤è¯†çš„è´¦æˆ·è¦ä»”ç»†æ ¸å®
3. "æƒé™è¿‡å¤§æœ‰é—®é¢˜" - æ™®é€šç”¨æˆ·ä¸åº”è¯¥æœ‰ç®¡ç†å‘˜æƒé™
4. "ç™»å½•è®°å½•çœ‹ç«¯å€ª" - å¼‚å¸¸æ—¶é—´ã€å¼‚å¸¸åœ°ç‚¹çš„ç™»å½•è¦æ³¨æ„

âš™ï¸ è¿›ç¨‹å®‰å…¨åˆ¤æ–­

ğŸš¨ å¯ç–‘è¿›ç¨‹ç‰¹å¾ï¼š
âœ— åœ¨ç³»ç»Ÿç›®å½•å¤–è¿è¡Œçš„ç³»ç»Ÿè¿›ç¨‹å
âœ— å ç”¨CPUæˆ–å†…å­˜å¼‚å¸¸é«˜çš„è¿›ç¨‹
âœ— è¿›ç¨‹è·¯å¾„åŒ…å«ä¸´æ—¶ç›®å½•ã€ä¸‹è½½ç›®å½•
âœ— è¿›ç¨‹åæ˜¯éšæœºå­—ç¬¦ä¸²æˆ–æ¨¡ä»¿ç³»ç»Ÿè¿›ç¨‹
âœ— PowerShellã€CMDé•¿æ—¶é—´è¿è¡Œ

âœ… æ­£å¸¸è¿›ç¨‹ç‰¹å¾ï¼š
âœ“ åœ¨æ­£ç¡®ç³»ç»Ÿç›®å½•ä¸‹çš„ç³»ç»Ÿè¿›ç¨‹
âœ“ æœ‰æ•°å­—ç­¾åçš„çŸ¥åè½¯ä»¶è¿›ç¨‹
âœ“ èµ„æºå ç”¨æ­£å¸¸çš„ä¸šåŠ¡è¿›ç¨‹
âœ“ å¯åŠ¨æ—¶é—´ä¸ç³»ç»Ÿå¯åŠ¨æ—¶é—´åŒ¹é…

ğŸ’¡ åˆ¤æ–­æŠ€å·§ï¼š
1. "ä½ç½®ä¸å¯¹å¿…æœ‰é¬¼" - ç³»ç»Ÿè¿›ç¨‹åº”è¯¥åœ¨ç³»ç»Ÿç›®å½•
2. "èµ„æºå ç”¨çœ‹å¼‚å¸¸" - CPUã€å†…å­˜å ç”¨è¿‡é«˜è¦æ³¨æ„
3. "è¿›ç¨‹æ ‘çœ‹å…³ç³»" - çˆ¶å­è¿›ç¨‹å…³ç³»è¦åˆç†
4. "ç­¾åéªŒè¯å¾ˆé‡è¦" - æ²¡æœ‰ç­¾åçš„è¿›ç¨‹è¦è°¨æ…

ğŸŒ ç½‘ç»œè¿æ¥åˆ¤æ–­

ğŸš¨ å±é™©ç½‘ç»œè¿æ¥ï¼š
âœ— è¿æ¥åˆ°å¯ç–‘å¤–ç½‘IPï¼ˆç‰¹åˆ«æ˜¯å¢ƒå¤–IPï¼‰
âœ— ä½¿ç”¨éæ ‡å‡†ç«¯å£çš„è¿æ¥
âœ— å¤§é‡å¹¶å‘è¿æ¥
âœ— è¿æ¥åˆ°å·²çŸ¥æ¶æ„IP
âœ— 4444ã€1234ç­‰å¸¸è§åé—¨ç«¯å£

âœ… æ­£å¸¸ç½‘ç»œè¿æ¥ï¼š
âœ“ è¿æ¥åˆ°å†…ç½‘æœåŠ¡å™¨
âœ“ ä½¿ç”¨æ ‡å‡†ç«¯å£ï¼ˆ80ã€443ã€22ã€3389ç­‰ï¼‰
âœ“ è¿æ¥åˆ°çŸ¥åæœåŠ¡å•†IP
âœ“ ä¸šåŠ¡ç›¸å…³çš„æ­£å¸¸è¿æ¥

ğŸ’¡ åˆ¤æ–­æŠ€å·§ï¼š
1. "å†…ç½‘è¿æ¥ç›¸å¯¹å®‰å…¨" - å†…ç½‘IPé€šå¸¸é£é™©è¾ƒä½
2. "å¤–ç½‘è¿æ¥è¦å®¡æŸ¥" - æ‰€æœ‰å¤–ç½‘è¿æ¥éƒ½è¦ç¡®è®¤å¿…è¦æ€§
3. "ç«¯å£å¼‚å¸¸è¦è­¦æƒ•" - éæ ‡å‡†ç«¯å£è¿æ¥è¦é‡ç‚¹å…³æ³¨
4. "æµé‡å¤§å°çœ‹å¼‚å¸¸" - å¼‚å¸¸å¤§çš„æ•°æ®ä¼ è¾“è¦æ³¨æ„
`,
    "ğŸ“‹ æ£€æŸ¥æ¸…å•": `
Windowsåº”æ€¥å“åº”æ£€æŸ¥æ¸…å•

ğŸš¨ ç´§æ€¥å¤„ç½®æ¸…å•ï¼ˆ30åˆ†é’Ÿå†…å®Œæˆï¼‰
â–¡ 1. ç¡®è®¤å®‰å…¨äº‹ä»¶æ€§è´¨å’Œå½±å“èŒƒå›´
â–¡ 2. é€šçŸ¥åº”æ€¥å“åº”å›¢é˜Ÿå’Œç®¡ç†å±‚
â–¡ 3. éš”ç¦»å—å½±å“ç³»ç»Ÿï¼ˆæ–­ç½‘ä¸å…³æœºï¼‰
â–¡ 4. ä¿æŠ¤ç°åœºï¼Œé¿å…è¯æ®ç ´å
â–¡ 5. æ”¶é›†åˆæ­¥è¯æ®å’Œæ—¥å¿—
â–¡ 6. è¯„ä¼°ä¸šåŠ¡å½±å“å’Œé£é™©ç­‰çº§
â–¡ 7. å¯åŠ¨ç›¸åº”çº§åˆ«çš„åº”æ€¥é¢„æ¡ˆ
â–¡ 8. å»ºç«‹äº‹ä»¶å¤„ç†è®°å½•

ğŸ” è¯¦ç»†åˆ†ææ¸…å•ï¼ˆ2å°æ—¶å†…å®Œæˆï¼‰

ç”¨æˆ·è´¦æˆ·å®‰å…¨æ£€æŸ¥ï¼š
â–¡ æ£€æŸ¥æ‰€æœ‰ç”¨æˆ·è´¦æˆ·çŠ¶æ€
â–¡ ç¡®è®¤ç®¡ç†å‘˜æƒé™åˆ†é…
â–¡ å®¡æŸ¥æœ€è¿‘çš„æƒé™å˜æ›´
â–¡ æ£€æŸ¥å¼‚å¸¸ç™»å½•è®°å½•

è¿›ç¨‹å’ŒæœåŠ¡æ£€æŸ¥ï¼š
â–¡ åˆ†ææ‰€æœ‰è¿è¡Œè¿›ç¨‹
â–¡ æ£€æŸ¥ç³»ç»ŸæœåŠ¡çŠ¶æ€
â–¡ ç¡®è®¤è¿›ç¨‹çš„åˆæ³•æ€§
â–¡ æŸ¥çœ‹è¿›ç¨‹ç½‘ç»œè¿æ¥

ç½‘ç»œè¿æ¥åˆ†æï¼š
â–¡ æ£€æŸ¥æ‰€æœ‰ç½‘ç»œè¿æ¥
â–¡ åˆ†æå¯ç–‘IPåœ°å€
â–¡ ç¡®è®¤ç«¯å£ä½¿ç”¨æƒ…å†µ
â–¡ æ£€æŸ¥é˜²ç«å¢™æ—¥å¿—

æ–‡ä»¶ç³»ç»Ÿæ£€æŸ¥ï¼š
â–¡ æ‰«ææ¶æ„è½¯ä»¶
â–¡ æ£€æŸ¥ç³»ç»Ÿæ–‡ä»¶å®Œæ•´æ€§
â–¡ åˆ†ææœ€è¿‘ä¿®æ”¹çš„æ–‡ä»¶
â–¡ æŸ¥çœ‹ä¸´æ—¶ç›®å½•å†…å®¹

æ—¥å¿—åˆ†æï¼š
â–¡ åˆ†æå®‰å…¨äº‹ä»¶æ—¥å¿—
â–¡ æ£€æŸ¥ç³»ç»Ÿé”™è¯¯æ—¥å¿—
â–¡ å®¡æŸ¥åº”ç”¨ç¨‹åºæ—¥å¿—
â–¡ åˆ†æç½‘ç»œè®¾å¤‡æ—¥å¿—

ğŸ› ï¸ ç³»ç»ŸåŠ å›ºæ¸…å•ï¼ˆ24å°æ—¶å†…å®Œæˆï¼‰

è´¦æˆ·å®‰å…¨åŠ å›ºï¼š
â–¡ é‡ç½®æ‰€æœ‰ç”¨æˆ·å¯†ç 
â–¡ å¯ç”¨è´¦æˆ·é”å®šç­–ç•¥
â–¡ é…ç½®å¯†ç å¤æ‚åº¦è¦æ±‚
â–¡ å¯ç”¨å¤šå› ç´ è®¤è¯

ç³»ç»Ÿå®‰å…¨åŠ å›ºï¼š
â–¡ å®‰è£…æœ€æ–°å®‰å…¨è¡¥ä¸
â–¡ æ›´æ–°é˜²ç—…æ¯’è½¯ä»¶
â–¡ é…ç½®é˜²ç«å¢™è§„åˆ™
â–¡ å¯ç”¨ç³»ç»Ÿå®¡è®¡

ç½‘ç»œå®‰å…¨åŠ å›ºï¼š
â–¡ æ›´æ–°ç½‘ç»œè®¾å¤‡é…ç½®
â–¡ åŠ å¼ºè®¿é—®æ§åˆ¶
â–¡ éƒ¨ç½²å…¥ä¾µæ£€æµ‹ç³»ç»Ÿ
â–¡ é…ç½®ç½‘ç»œç›‘æ§

ç›‘æ§èƒ½åŠ›æå‡ï¼š
â–¡ åŠ å¼ºæ—¥å¿—è®°å½•
â–¡ éƒ¨ç½²å®‰å…¨ç›‘æ§å·¥å…·
â–¡ é…ç½®å‘Šè­¦è§„åˆ™
â–¡ å»ºç«‹å¨èƒæƒ…æŠ¥æº
`,
    "ğŸ’¡ ä¸“ä¸šå»ºè®®": `
Windowsåº”æ€¥å“åº”ä¸“ä¸šå»ºè®®

ğŸ¯ å®æˆ˜åº”æ€¥å“åº”æŠ€å·§

1åˆ†é’Ÿå¿«é€Ÿæ£€æŸ¥æ³•ï¼š
# æ£€æŸ¥å¼‚å¸¸ç”¨æˆ·ï¼ˆé‡ç‚¹å…³æ³¨ï¼‰
net user
# çœ‹æ˜¯å¦æœ‰é™Œç”Ÿç”¨æˆ·ï¼Œç‰¹åˆ«æ˜¯ç®¡ç†å‘˜ç»„çš„

# æ£€æŸ¥å¼‚å¸¸è¿›ç¨‹ï¼ˆé‡ç‚¹å…³æ³¨ï¼‰
tasklist /svc
# çœ‹æ˜¯å¦æœ‰å¯ç–‘è¿›ç¨‹ï¼Œç‰¹åˆ«æ˜¯é«˜CPUå ç”¨çš„

# æ£€æŸ¥ç½‘ç»œè¿æ¥ï¼ˆé‡ç‚¹å…³æ³¨ï¼‰
netstat -an
# çœ‹æ˜¯å¦æœ‰å¯ç–‘å¤–ç½‘è¿æ¥ï¼Œç‰¹åˆ«æ˜¯éæ ‡å‡†ç«¯å£

# æ£€æŸ¥ç³»ç»ŸæœåŠ¡
sc query type= service state= all
# çœ‹æ˜¯å¦æœ‰å¯ç–‘æœåŠ¡

5åˆ†é’Ÿæ·±åº¦æ£€æŸ¥æ³•ï¼š
# æ£€æŸ¥ç™»å½•æ—¥å¿—
eventvwr.msc
# æŸ¥çœ‹å®‰å…¨æ—¥å¿—ï¼Œå…³æ³¨ç™»å½•å¤±è´¥å’ŒæˆåŠŸè®°å½•

# æ£€æŸ¥å¯åŠ¨é¡¹
msconfig
# æŸ¥çœ‹æ˜¯å¦æœ‰å¯ç–‘çš„å¯åŠ¨ç¨‹åº

# æ£€æŸ¥è®¡åˆ’ä»»åŠ¡
taskschd.msc
# æŸ¥çœ‹æ˜¯å¦æœ‰å¯ç–‘çš„è®¡åˆ’ä»»åŠ¡

# æ£€æŸ¥ç³»ç»Ÿæ–‡ä»¶
sfc /scannow
# æ£€æŸ¥ç³»ç»Ÿæ–‡ä»¶å®Œæ•´æ€§

ğŸ” å¸¸è§æ”»å‡»æ‰‹æ³•è¯†åˆ«

æƒé™æå‡æ”»å‡»ï¼š
ç‰¹å¾ï¼š
- æ™®é€šç”¨æˆ·çªç„¶è·å¾—ç®¡ç†å‘˜æƒé™
- ç³»ç»Ÿä¸­å‡ºç°æ–°çš„ç®¡ç†å‘˜è´¦æˆ·
- å‘ç°æƒé™æå‡å·¥å…·æˆ–è„šæœ¬

åº”å¯¹ï¼š
- ç«‹å³æ£€æŸ¥æ‰€æœ‰ç”¨æˆ·æƒé™
- å®¡æŸ¥æƒé™å˜æ›´æ—¥å¿—
- é‡ç½®æ‰€æœ‰è´¦æˆ·å¯†ç 

åé—¨æ¤å…¥ï¼š
ç‰¹å¾ï¼š
- å‘ç°å¯ç–‘çš„ç½‘ç»œè¿æ¥
- ç³»ç»Ÿä¸­å‡ºç°æœªçŸ¥çš„å¯æ‰§è¡Œæ–‡ä»¶
- é˜²ç«å¢™è§„åˆ™è¢«å¼‚å¸¸ä¿®æ”¹

åº”å¯¹ï¼š
- æ–­å¼€ç½‘ç»œè¿æ¥
- æŸ¥æ€æ¶æ„è½¯ä»¶
- æ£€æŸ¥ç³»ç»Ÿå®Œæ•´æ€§

æ•°æ®çªƒå–ï¼š
ç‰¹å¾ï¼š
- å¼‚å¸¸çš„æ–‡ä»¶è®¿é—®è®°å½•
- å¤§é‡æ•°æ®ä¼ è¾“æ´»åŠ¨
- æ•æ„Ÿæ–‡ä»¶è¢«å¼‚å¸¸è®¿é—®

åº”å¯¹ï¼š
- ç«‹å³ä¿æŠ¤æ•æ„Ÿæ•°æ®
- åˆ†æè®¿é—®æ—¥å¿—
- è¯„ä¼°æ•°æ®æ³„éœ²é£é™©

ğŸ‘¥ åº”æ€¥å“åº”å›¢é˜Ÿå»ºè®¾

å›¢é˜Ÿè§’è‰²åˆ†å·¥ï¼š
- äº‹ä»¶æŒ‡æŒ¥å®˜ï¼šç»Ÿç­¹åè°ƒï¼Œå†³ç­–æŒ‡æŒ¥
- æŠ€æœ¯åˆ†æå¸ˆï¼šæŠ€æœ¯åˆ†æï¼Œå¨èƒç ”åˆ¤
- ç³»ç»Ÿç®¡ç†å‘˜ï¼šç³»ç»Ÿæ“ä½œï¼Œæ¢å¤å¤„ç†
- å®‰å…¨å·¥ç¨‹å¸ˆï¼šå®‰å…¨åŠ å›ºï¼Œé˜²æŠ¤éƒ¨ç½²
- æ³•åŠ¡ä¸“å‘˜ï¼šæ³•å¾‹åˆè§„ï¼Œè¯æ®ä¿å…¨
- æ²Ÿé€šåè°ƒå‘˜ï¼šå†…å¤–æ²Ÿé€šï¼Œä¿¡æ¯å‘å¸ƒ

ğŸ› ï¸ å·¥å…·å’ŒæŠ€æœ¯å‡†å¤‡

å¿…å¤‡å·¥å…·æ¸…å•ï¼š
- åº”æ€¥å“åº”è„šæœ¬ï¼ˆæœ¬å·¥å…·ï¼‰
- æ¶æ„è½¯ä»¶æ‰«æå·¥å…·
- ç½‘ç»œåˆ†æå·¥å…·
- æ—¥å¿—åˆ†æå·¥å…·
- å–è¯åˆ†æå·¥å…·
- ç³»ç»Ÿç›‘æ§å·¥å…·

ğŸ›¡ï¸ é¢„é˜²æªæ–½å»ºè®®

æ—¥å¸¸å®‰å…¨æªæ–½ï¼š
1. å®šæœŸå®‰å…¨è¯„ä¼°å’Œæ¸—é€æµ‹è¯•
2. å»ºç«‹å®Œå–„çš„ç›‘æ§å’Œå‘Šè­¦ä½“ç³»
3. åˆ¶å®šè¯¦ç»†çš„åº”æ€¥å“åº”é¢„æ¡ˆ
4. å®šæœŸè¿›è¡Œåº”æ€¥æ¼”ç»ƒ
5. åŠ å¼ºå‘˜å·¥å®‰å…¨æ„è¯†åŸ¹è®­
6. å»ºç«‹å¨èƒæƒ…æŠ¥æ”¶é›†æœºåˆ¶
`,
    "ğŸ› ï¸ å·¥å…·ä½¿ç”¨": `
Windowsåº”æ€¥å“åº”å·¥å…·ä½¿ç”¨æŒ‡å—

ğŸ”§ æœ¬å·¥å…·ä½¿ç”¨æ–¹æ³•

1. æ•°æ®æ”¶é›†é˜¶æ®µï¼š
   - è¿è¡ŒPowerShellè„šæœ¬ï¼šwindows_emergency_response.ps1
   - è„šæœ¬ä¼šè‡ªåŠ¨æ”¶é›†ç³»ç»Ÿä¿¡æ¯ã€ç”¨æˆ·ä¿¡æ¯ã€è¿›ç¨‹ä¿¡æ¯ç­‰
   - ç”Ÿæˆè¯¦ç»†çš„åº”æ€¥å“åº”æŠ¥å‘Šæ–‡ä»¶

2. æ•°æ®åˆ†æé˜¶æ®µï¼š
   - å¯åŠ¨Webåˆ†æå¹³å°ï¼špython windows_rules_engine.py
   - è®¿é—®ä¸»é¡µé¢ï¼šhttp://localhost:12002
   - ä¸Šä¼ æŠ¥å‘Šæ–‡ä»¶è¿›è¡Œæ™ºèƒ½åˆ†æ

3. ç»“æœæŸ¥çœ‹é˜¶æ®µï¼š
   - æŸ¥çœ‹åˆ†æç»“æœå’Œå®‰å…¨å‘Šè­¦
   - è·å–ä¸“ä¸šçš„å¤„ç½®å»ºè®®
   - ä¸‹è½½è¯¦ç»†çš„åˆ†ææŠ¥å‘Š

ğŸ› ï¸ ç³»ç»Ÿå†…ç½®å·¥å…·

Windowsäº‹ä»¶æŸ¥çœ‹å™¨ï¼š
eventvwr.msc
- æŸ¥çœ‹ç³»ç»Ÿæ—¥å¿—ã€å®‰å…¨æ—¥å¿—ã€åº”ç”¨ç¨‹åºæ—¥å¿—
- é‡ç‚¹å…³æ³¨ç™»å½•äº‹ä»¶ã€æƒé™å˜æ›´äº‹ä»¶

ä»»åŠ¡ç®¡ç†å™¨ï¼š
taskmgr.exe
- æŸ¥çœ‹è¿è¡Œè¿›ç¨‹å’Œç³»ç»Ÿæ€§èƒ½
- è¯†åˆ«å¼‚å¸¸è¿›ç¨‹å’Œèµ„æºå ç”¨

ç³»ç»Ÿé…ç½®ï¼š
msconfig.exe
- æŸ¥çœ‹å¯åŠ¨é¡¹å’Œç³»ç»ŸæœåŠ¡
- ç¦ç”¨å¯ç–‘çš„å¯åŠ¨ç¨‹åº

æ³¨å†Œè¡¨ç¼–è¾‘å™¨ï¼š
regedit.exe
- æ£€æŸ¥æ³¨å†Œè¡¨å¯åŠ¨é¡¹
- æŸ¥çœ‹ç³»ç»Ÿé…ç½®ä¿¡æ¯

ç½‘ç»œè¿æ¥æŸ¥çœ‹ï¼š
netstat -an
- æŸ¥çœ‹æ‰€æœ‰ç½‘ç»œè¿æ¥
- è¯†åˆ«å¯ç–‘çš„å¤–ç½‘è¿æ¥

ç”¨æˆ·è´¦æˆ·ç®¡ç†ï¼š
net user
lusrmgr.msc
- æŸ¥çœ‹æ‰€æœ‰ç”¨æˆ·è´¦æˆ·
- ç®¡ç†ç”¨æˆ·æƒé™

ğŸ” ç¬¬ä¸‰æ–¹æ¨èå·¥å…·

Sysinternals Suiteï¼š
- Process Explorerï¼šè¯¦ç»†è¿›ç¨‹åˆ†æ
- Autorunsï¼šå¯åŠ¨é¡¹å…¨é¢æ£€æŸ¥
- TCPViewï¼šç½‘ç»œè¿æ¥å®æ—¶ç›‘æ§
- PsExecï¼šè¿œç¨‹æ‰§è¡Œå‘½ä»¤

å®‰å…¨æ‰«æå·¥å…·ï¼š
- Malwarebytesï¼šæ¶æ„è½¯ä»¶æ‰«æ
- YARAï¼šæ¶æ„ä»£ç æ£€æµ‹è§„åˆ™
- Volatilityï¼šå†…å­˜å–è¯åˆ†æ
- Wiresharkï¼šç½‘ç»œæµé‡åˆ†æ

ğŸ“Š æ—¥å¿—åˆ†æå·¥å…·

Windows PowerShellï¼š
Get-WinEvent -LogName Security
Get-WinEvent -LogName System
Get-WinEvent -LogName Application

äº‹ä»¶IDé‡ç‚¹å…³æ³¨ï¼š
- 4624ï¼šæˆåŠŸç™»å½•
- 4625ï¼šç™»å½•å¤±è´¥
- 4648ï¼šä½¿ç”¨æ˜¾å¼å‡­æ®ç™»å½•
- 4672ï¼šåˆ†é…ç‰¹æ®Šæƒé™
- 4720ï¼šåˆ›å»ºç”¨æˆ·è´¦æˆ·
- 4726ï¼šåˆ é™¤ç”¨æˆ·è´¦æˆ·
- 4728ï¼šå°†æˆå‘˜æ·»åŠ åˆ°å®‰å…¨ç»„
- 4732ï¼šå°†æˆå‘˜æ·»åŠ åˆ°æœ¬åœ°ç»„

ğŸ¯ å®æˆ˜æŠ€å·§

å¿«é€Ÿæ’æŸ¥å‘½ä»¤ç»„åˆï¼š
# ä¸€é”®æ£€æŸ¥ç”¨æˆ·å’Œæƒé™
net user & net localgroup administrators

# ä¸€é”®æ£€æŸ¥è¿›ç¨‹å’ŒæœåŠ¡
tasklist /svc & sc query type= service state= all

# ä¸€é”®æ£€æŸ¥ç½‘ç»œè¿æ¥
netstat -an & netstat -b

# ä¸€é”®æ£€æŸ¥å¯åŠ¨é¡¹
wmic startup get caption,command,location

# ä¸€é”®æ£€æŸ¥è®¡åˆ’ä»»åŠ¡
schtasks /query /fo table /v

è‡ªåŠ¨åŒ–è„šæœ¬ç¤ºä¾‹ï¼š
@echo off
echo å¼€å§‹åº”æ€¥å“åº”å¿«é€Ÿæ£€æŸ¥...
echo.
echo 1. æ£€æŸ¥ç”¨æˆ·è´¦æˆ·
net user
echo.
echo 2. æ£€æŸ¥ç®¡ç†å‘˜ç»„
net localgroup administrators
echo.
echo 3. æ£€æŸ¥è¿è¡Œè¿›ç¨‹
tasklist
echo.
echo 4. æ£€æŸ¥ç½‘ç»œè¿æ¥
netstat -an
echo.
echo 5. æ£€æŸ¥å¯åŠ¨é¡¹
wmic startup get caption,command
echo.
echo åº”æ€¥å“åº”å¿«é€Ÿæ£€æŸ¥å®Œæˆï¼
`,
    "ğŸ“š å­¦ä¹ èµ„æº": `
Windowsåº”æ€¥å“åº”å­¦ä¹ èµ„æº

ğŸ“– å®˜æ–¹æ–‡æ¡£

Microsoft Security Response Center
- Windowså®‰å…¨æœ€ä½³å®è·µ
- å®‰å…¨æ›´æ–°å’Œæ¼æ´ä¿¡æ¯
- äº‹ä»¶å“åº”æŒ‡å—

NIST Cybersecurity Framework
- ç½‘ç»œå®‰å…¨æ¡†æ¶æ ‡å‡†
- äº‹ä»¶å“åº”æµç¨‹è§„èŒƒ
- é£é™©ç®¡ç†æŒ‡å¯¼

SANS Incident Response Guide
- äº‹ä»¶å“åº”æœ€ä½³å®è·µ
- å®æˆ˜æ¡ˆä¾‹åˆ†æ
- å·¥å…·ä½¿ç”¨æŒ‡å—

ğŸ› ï¸ å®ç”¨å·¥å…·å­¦ä¹ 

Sysinternals Suite
- å®˜æ–¹æ–‡æ¡£å’Œä½¿ç”¨æ•™ç¨‹
- å®æˆ˜æ¡ˆä¾‹åˆ†æ
- é«˜çº§åŠŸèƒ½è¯¦è§£

YARA Rules
- æ¶æ„ä»£ç æ£€æµ‹è§„åˆ™ç¼–å†™
- è§„åˆ™åº“ç»´æŠ¤å’Œæ›´æ–°
- è‡ªå®šä¹‰æ£€æµ‹è§„åˆ™

Volatility Framework
- å†…å­˜å–è¯åˆ†ææŠ€æœ¯
- æ¶æ„è½¯ä»¶å†…å­˜åˆ†æ
- é«˜çº§å–è¯æŠ€å·§

Wireshark
- ç½‘ç»œæµé‡åˆ†ææŠ€æœ¯
- åè®®åˆ†æå’Œè§£ç 
- ç½‘ç»œå®‰å…¨ç›‘æ§

ğŸ“ åŸ¹è®­è®¤è¯

GCIH (GIAC Certified Incident Handler)
- äº‹ä»¶å¤„ç†ä¸“ä¸šè®¤è¯
- å®æˆ˜æŠ€èƒ½éªŒè¯
- è¡Œä¸šè®¤å¯åº¦é«˜

GCFA (GIAC Certified Forensic Analyst)
- æ•°å­—å–è¯åˆ†æè®¤è¯
- æ·±åº¦æŠ€æœ¯èƒ½åŠ›
- æ³•åº­è¯æ®å¤„ç†

CISSP (Certified Information Systems Security Professional)
- ä¿¡æ¯å®‰å…¨ä¸“ä¸šè®¤è¯
- å…¨é¢å®‰å…¨çŸ¥è¯†ä½“ç³»
- ç®¡ç†å±‚è®¤å¯

CISM (Certified Information Security Manager)
- ä¿¡æ¯å®‰å…¨ç®¡ç†è®¤è¯
- æˆ˜ç•¥è§„åˆ’èƒ½åŠ›
- é£é™©ç®¡ç†ä¸“é•¿

ğŸ“š æ¨èä¹¦ç±

ã€ŠWindows Internalsã€‹
- Windowsç³»ç»Ÿå†…éƒ¨æœºåˆ¶
- æ·±åº¦æŠ€æœ¯åŸç†
- ç³»ç»Ÿè°ƒè¯•æŠ€å·§

ã€ŠMalware Analyst's Cookbookã€‹
- æ¶æ„è½¯ä»¶åˆ†ææŠ€æœ¯
- å®æˆ˜åˆ†ææ¡ˆä¾‹
- å·¥å…·ä½¿ç”¨æŒ‡å—

ã€ŠIncident Response & Computer Forensicsã€‹
- äº‹ä»¶å“åº”å®Œæ•´æµç¨‹
- è®¡ç®—æœºå–è¯æŠ€æœ¯
- æ³•å¾‹åˆè§„è¦æ±‚

ã€ŠThe Art of Memory Forensicsã€‹
- å†…å­˜å–è¯åˆ†ææŠ€æœ¯
- é«˜çº§åˆ†ææ–¹æ³•
- å®æˆ˜æ¡ˆä¾‹ç ”ç©¶

ğŸŒ åœ¨çº¿èµ„æº

GitHubå®‰å…¨é¡¹ç›®
- å¼€æºå®‰å…¨å·¥å…·
- æ£€æµ‹è§„åˆ™åº“
- ç¤¾åŒºè´¡çŒ®ä»£ç 

å®‰å…¨åšå®¢å’Œè®ºå›
- æœ€æ–°å¨èƒæƒ…æŠ¥
- æŠ€æœ¯åˆ†ææ–‡ç« 
- ç»éªŒåˆ†äº«äº¤æµ

å®‰å…¨ä¼šè®®å’ŒåŸ¹è®­
- Black Hat / DEF CON
- RSA Conference
- å›½å†…å®‰å…¨ä¼šè®®

å®éªŒç¯å¢ƒæ­å»º
- VirtualBox / VMware
- Windowsè™šæ‹Ÿæœº
- æ¶æ„è½¯ä»¶åˆ†æç¯å¢ƒ

ğŸ¯ å­¦ä¹ è·¯å¾„å»ºè®®

åˆçº§é˜¶æ®µï¼ˆ1-3ä¸ªæœˆï¼‰ï¼š
1. æŒæ¡Windowsç³»ç»ŸåŸºç¡€çŸ¥è¯†
2. å­¦ä¹ åŸºæœ¬çš„å‘½ä»¤è¡Œæ“ä½œ
3. äº†è§£å¸¸è§çš„å®‰å…¨å¨èƒ
4. ç†Ÿæ‚‰åŸºç¡€å®‰å…¨å·¥å…·

ä¸­çº§é˜¶æ®µï¼ˆ3-6ä¸ªæœˆï¼‰ï¼š
1. æ·±å…¥å­¦ä¹ äº‹ä»¶å“åº”æµç¨‹
2. æŒæ¡æ—¥å¿—åˆ†ææŠ€æœ¯
3. å­¦ä¹ æ¶æ„è½¯ä»¶åˆ†æåŸºç¡€
4. å®è·µåº”æ€¥å“åº”æ¡ˆä¾‹

é«˜çº§é˜¶æ®µï¼ˆ6-12ä¸ªæœˆï¼‰ï¼š
1. æŒæ¡é«˜çº§å–è¯åˆ†ææŠ€æœ¯
2. å­¦ä¹ å¨èƒç‹©çŒæ–¹æ³•
3. å¼€å‘è‡ªå®šä¹‰æ£€æµ‹è§„åˆ™
4. å»ºç«‹å®Œæ•´çš„å“åº”ä½“ç³»

ä¸“å®¶é˜¶æ®µï¼ˆ1å¹´ä»¥ä¸Šï¼‰ï¼š
1. ç ”ç©¶æœ€æ–°æ”»å‡»æŠ€æœ¯
2. å¼€å‘å®‰å…¨å·¥å…·å’Œå¹³å°
3. æŒ‡å¯¼å›¢é˜Ÿå’ŒåŸ¹è®­ä»–äºº
4. å‚ä¸å®‰å…¨æ ‡å‡†åˆ¶å®š

ğŸ’¡ å®è·µå»ºè®®

1. æ­å»ºå®éªŒç¯å¢ƒè¿›è¡Œç»ƒä¹ 
2. å‚ä¸CTFç«èµ›æå‡æŠ€èƒ½
3. å…³æ³¨å®‰å…¨ç¤¾åŒºå’Œè®ºå›
4. å®šæœŸè¿›è¡Œåº”æ€¥æ¼”ç»ƒ
5. è®°å½•å’Œåˆ†äº«å­¦ä¹ å¿ƒå¾—
6. ä¸åŒè¡Œäº¤æµç»éªŒ

è®°ä½ï¼šåº”æ€¥å“åº”æ˜¯ä¸€ä¸ªéœ€è¦æŒç»­å­¦ä¹ å’Œå®è·µçš„é¢†åŸŸï¼Œä¿æŒå¥½å¥‡å¿ƒå’Œå­¦ä¹ çƒ­æƒ…æ˜¯æˆåŠŸçš„å…³é”®ï¼ğŸ›¡ï¸
`
  };
}

// æ¸²æŸ“æ ‡ç­¾é¡µ
function renderTabs(data) {
  analysisData = data;
  
  const tabBtnHtml = gTabs.map((k, i) => 
    `<button class="tablinks" onclick="openTab(event, '${k}')">${TAB_TITLES[k]}</button>`
  ).join("");
  document.getElementById("tabBtns").innerHTML = tabBtnHtml;

  const tabContentHtml = gTabs.map(k => {
    const subTitles = SUB_TAB_TITLES[k];
    const subContent = subTitles.map(title => {
      let content = "";
      if (title === 'ğŸ“š æ’æŸ¥æ•™ç¨‹') {
        content = generateWindowsTutorial(k);
        return `<details><summary>${title}</summary><div style="padding: 10px;">${content}</div></details>`;
      } else {
        content = data[k] && data[k][title] ? data[k][title] : "";
        return `<details open><summary>${title}</summary><pre>${escapeHtml(content)}</pre></details>`;
      }
    }).join("");
    return `<div id="${k}" class="tabcontent">${subContent}</div>`;
  }).join("");
  document.getElementById("tabContents").innerHTML = tabContentHtml;

  if (gTabs.length) {
    setTimeout(() => document.getElementsByClassName("tablinks")[0].click(), 100);
  }
  
  // è°ƒç”¨è§„åˆ™å¼•æ“APIè¿›è¡Œåˆ†æï¼ˆå¦‚æœè¿˜æ²¡æœ‰åˆ†æè¿‡ï¼‰
  if (!skipAnalysis) {
    analyzeReport(data);
  }
}

// HTMLè½¬ä¹‰å‡½æ•°
function escapeHtml(text) {
  const div = document.createElement('div');
  div.textContent = text;
  return div.innerHTML;
}

// æ‰“å¼€æ ‡ç­¾é¡µ
function openTab(evt, tabName) {
  const tabcontent = document.getElementsByClassName("tabcontent");
  for (let i = 0; i < tabcontent.length; i++) {
    tabcontent[i].style.display = "none";
  }
  const tablinks = document.getElementsByClassName("tablinks");
  for (let i = 0; i < tablinks.length; i++) {
    tablinks[i].className = tablinks[i].className.replace(" active", "");
  }
  document.getElementById(tabName).style.display = "block";
  evt.currentTarget.className += " active";
}

// æœç´¢åŠŸèƒ½
function searchTabs() {
  const searchTerm = document.getElementById('searchInput').value.toLowerCase();
  const searchCount = document.getElementById('searchCount');
  const prevBtn = document.getElementById('prevMatch');
  const nextBtn = document.getElementById('nextMatch');
  
  // æ¸…é™¤ä¹‹å‰çš„é«˜äº®
  clearHighlights();
  
  if (searchTerm.length < 2) {
    searchCount.textContent = "è¾“å…¥å…³é”®è¯æœç´¢";
    prevBtn.disabled = true;
    nextBtn.disabled = true;
    searchMatches = [];
    currentSearchIndex = -1;
    return;
  }
  
  // æŸ¥æ‰¾åŒ¹é…é¡¹
  searchMatches = [];
  const allContent = document.querySelectorAll('.tabcontent pre, .tabcontent div');
  
  allContent.forEach((element, elementIndex) => {
    const text = element.textContent || element.innerText;
    const regex = new RegExp(searchTerm, 'gi');
    let match;
    
    while ((match = regex.exec(text)) !== null) {
      searchMatches.push({
        element: element,
        index: match.index,
        length: searchTerm.length,
        elementIndex: elementIndex
      });
    }
  });
  
  if (searchMatches.length > 0) {
    searchCount.textContent = `æ‰¾åˆ° ${searchMatches.length} ä¸ªåŒ¹é…é¡¹`;
    prevBtn.disabled = false;
    nextBtn.disabled = false;
    currentSearchIndex = 0;
    highlightMatches();
    navigateToMatch(0);
  } else {
    searchCount.textContent = "æœªæ‰¾åˆ°åŒ¹é…é¡¹";
    prevBtn.disabled = true;
    nextBtn.disabled = true;
  }
}

// é«˜äº®åŒ¹é…é¡¹
function highlightMatches() {
  searchMatches.forEach((match, index) => {
    const element = match.element;
    const text = element.innerHTML;
    const searchTerm = document.getElementById('searchInput').value;
    const regex = new RegExp(`(${escapeRegExp(searchTerm)})`, 'gi');
    const highlightedText = text.replace(regex, `<span class="highlight" data-match-index="${index}">$1</span>`);
    element.innerHTML = highlightedText;
  });
}

// æ¸…é™¤é«˜äº®
function clearHighlights() {
  const highlights = document.querySelectorAll('.highlight');
  highlights.forEach(highlight => {
    const parent = highlight.parentNode;
    parent.replaceChild(document.createTextNode(highlight.textContent), highlight);
    parent.normalize();
  });
}

// å¯¼èˆªåˆ°åŒ¹é…é¡¹
function navigateSearch(direction) {
  if (searchMatches.length === 0) return;
  
  currentSearchIndex += direction;
  if (currentSearchIndex >= searchMatches.length) {
    currentSearchIndex = 0;
  } else if (currentSearchIndex < 0) {
    currentSearchIndex = searchMatches.length - 1;
  }
  
  navigateToMatch(currentSearchIndex);
  document.getElementById('searchCount').textContent = 
    `ç¬¬ ${currentSearchIndex + 1} ä¸ªï¼Œå…± ${searchMatches.length} ä¸ªåŒ¹é…é¡¹`;
}

// å¯¼èˆªåˆ°æŒ‡å®šåŒ¹é…é¡¹
function navigateToMatch(index) {
  const match = searchMatches[index];
  const highlight = document.querySelector(`[data-match-index="${index}"]`);
  
  if (highlight) {
    // æ‰¾åˆ°åŒ…å«è¯¥å…ƒç´ çš„æ ‡ç­¾é¡µ
    let tabContent = highlight.closest('.tabcontent');
    if (tabContent) {
      // æ¿€æ´»å¯¹åº”çš„æ ‡ç­¾é¡µ
      const tabId = tabContent.id;
      const tabButton = document.querySelector(`[onclick="openTab(event, '${tabId}')"]`);
      if (tabButton) {
        tabButton.click();
      }
      
      // å±•å¼€å¯¹åº”çš„detailså…ƒç´ 
      const details = highlight.closest('details');
      if (details) {
        details.open = true;
        details.scrollIntoView({ behavior: 'smooth', block: 'center' });
      }
    }
  }
}

// è½¬ä¹‰æ­£åˆ™è¡¨è¾¾å¼ç‰¹æ®Šå­—ç¬¦
function escapeRegExp(string) {
  return string.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
}

// è°ƒç”¨è§„åˆ™å¼•æ“åˆ†æ
async function analyzeReport(data) {
  try {
    // å°†æ•°æ®è½¬æ¢ä¸ºæ–‡æœ¬æ ¼å¼è¿›è¡Œåˆ†æ
    const reportText = JSON.stringify(data, null, 2);
    
    const response = await fetch('/analyze', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({ content: reportText })
    });
    
    if (response.ok) {
      const result = await response.json();
      displayAlerts(result.alerts || []);
    }
  } catch (error) {
    console.log('è§„åˆ™å¼•æ“åˆ†æå¤±è´¥ï¼Œä½¿ç”¨æœ¬åœ°åˆ†ææ¨¡å¼');
    performLocalAnalysis(data);
  }
}

// æœ¬åœ°åˆ†ææ¨¡å¼
function performLocalAnalysis(data) {
  const alerts = [];
  
  // ç®€å•çš„æœ¬åœ°è§„åˆ™æ£€æŸ¥
  const reportText = JSON.stringify(data, null, 2);
  
  if (reportText.includes('å®æ—¶ä¿æŠ¤: False')) {
    alerts.push({
      rule_name: 'Windows Defenderå…³é—­',
      description: 'Windows Defenderå®æ—¶ä¿æŠ¤å·²å…³é—­',
      severity: 'high',
      category: 'antivirus'
    });
  }
  
  if (reportText.includes('å¯ç–‘è¿›ç¨‹') || reportText.includes('å¼‚å¸¸è¿›ç¨‹')) {
    alerts.push({
      rule_name: 'å¯ç–‘è¿›ç¨‹æ£€æµ‹',
      description: 'å‘ç°å¯ç–‘çš„è¿›ç¨‹æ´»åŠ¨',
      severity: 'medium',
      category: 'process_security'
    });
  }
  
  displayAlerts(alerts);
}

// æ˜¾ç¤ºå‘Šè­¦
function displayAlerts(alerts) {
  const alertContainer = document.getElementById('alertContainer');
  const alertSummary = document.getElementById('alertSummary');
  
  if (alerts.length === 0) {
    alertContainer.innerHTML = `
      <div style="text-align: center; padding: 40px; color: #27ae60;">
        <h3>âœ… ç³»ç»ŸçŠ¶æ€è‰¯å¥½</h3>
        <p>æœªå‘ç°æ˜æ˜¾çš„å®‰å…¨å¨èƒ</p>
      </div>
    `;
    alertSummary.innerHTML = `
      <div style="color: #27ae60;">
        <strong>å®‰å…¨çŠ¶æ€: è‰¯å¥½</strong><br>
        å‘Šè­¦æ•°é‡: 0
      </div>
    `;
    return;
  }
  
  // ç»Ÿè®¡å‘Šè­¦
  const highAlerts = alerts.filter(a => a.severity === 'high').length;
  const mediumAlerts = alerts.filter(a => a.severity === 'medium').length;
  const lowAlerts = alerts.filter(a => a.severity === 'low').length;
  
  alertSummary.innerHTML = `
    <div>
      <strong>å®‰å…¨å‘Šè­¦ç»Ÿè®¡</strong><br>
      ğŸ”´ é«˜å±: ${highAlerts}<br>
      ğŸŸ¡ ä¸­å±: ${mediumAlerts}<br>
      ğŸŸ¢ ä½å±: ${lowAlerts}<br>
      æ€»è®¡: ${alerts.length}
    </div>
  `;
  
  // æ˜¾ç¤ºå‘Šè­¦è¯¦æƒ…
  let alertHtml = '';
  alerts.forEach(alert => {
    const alertClass = `alert-${alert.severity}`;
    const severityIcon = {
      'high': 'ğŸ”´',
      'medium': 'ğŸŸ¡', 
      'low': 'ğŸŸ¢'
    }[alert.severity] || 'âšª';
    
    alertHtml += `
      <div class="alert-item ${alertClass}">
        <h4>${severityIcon} ${alert.rule_name}</h4>
        <p><strong>æè¿°:</strong> ${alert.description}</p>
        <p><strong>ç±»åˆ«:</strong> ${alert.category}</p>
      </div>
    `;
  });
  
  alertContainer.innerHTML = alertHtml;
}

// åˆ‡æ¢ä¾§è¾¹æ 
function toggleSidebar() {
  const sidebar = document.querySelector('.sidebar');
  const button = document.querySelector('.collapse-button');
  
  sidebar.classList.toggle('collapsed');
  
  if (sidebar.classList.contains('collapsed')) {
    button.textContent = '< å±•å¼€å‘Šè­¦é¢æ¿';
  } else {
    button.textContent = 'æ”¶èµ·å‘Šè­¦é¢æ¿ >';
  }
}

</script>
</head>
<body>
  <div class="header">
    <h1>ğŸ›¡ï¸ Windows åº”æ€¥å“åº”æŠ¥å‘ŠæŸ¥çœ‹å™¨ (è¯¦ç»†ç‰ˆ)</h1>
    <div class="subtitle">ä¸“ä¸šåŒ–Windowså®‰å…¨å¨èƒæ£€æµ‹ä¸åˆ†æç³»ç»Ÿ | è¯¦ç»†æ—¥å¿—åˆ†æ + æ”»å‡»æº¯æº + æŠ€æœ¯æ•™ç¨‹</div>
  </div>

  <div class="main-container">
    <div class="content-container">
      <div class="search-container">
        <input type="file" id="fileInput" accept=".txt,.json">
        <input type="text" id="searchInput" placeholder="æœç´¢æŠ¥å‘Šå†…å®¹..." onkeyup="searchTabs()">
        <div class="search-nav">
          <button id="prevMatch" onclick="navigateSearch(-1)" disabled>ä¸Šä¸€ä¸ª</button>
          <button id="nextMatch" onclick="navigateSearch(1)" disabled>ä¸‹ä¸€ä¸ª</button>
          <span id="searchCount">è¾“å…¥å…³é”®è¯æœç´¢</span>
        </div>
      </div>

      <div class="tabs" id="tabBtns">
        <!-- æ ‡ç­¾æŒ‰é’®å°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
      </div>

      <div id="tabContents">
        <!-- æ ‡ç­¾å†…å®¹å°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
      </div>
    </div>

    <div class="sidebar">
      <div class="sidebar-header">
        <h3>ğŸš¨ å®‰å…¨å‘Šè­¦é¢æ¿</h3>
        <button class="collapse-button" onclick="toggleSidebar()">æ”¶èµ·å‘Šè­¦é¢æ¿ ></button>
        <div id="alertSummary" class="alert-summary">
          <!-- å‘Šè­¦ç»Ÿè®¡å°†åœ¨è¿™é‡Œæ˜¾ç¤º -->
        </div>
      </div>
      <div id="alertContainer" class="alert-container">
        <div style="text-align: center; padding: 40px; color: #666;">
          <p>ğŸ“ è¯·é€‰æ‹©æŠ¥å‘Šæ–‡ä»¶å¼€å§‹åˆ†æ</p>
          <p style="font-size: 0.9em; margin-top: 10px;">æ”¯æŒ .txt å’Œ .json æ ¼å¼</p>
        </div>
      </div>
    </div>
  </div>
</body>
</html>